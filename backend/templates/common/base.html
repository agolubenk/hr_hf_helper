{% load static %}
{% load huntflow_filters %}
{% load sidebar_tags %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title %}HR Helper{% endblock %}</title>
    
    <!-- Bootstrap CSS -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="{% static 'css/all.min.css' %}" rel="stylesheet">
    <!-- Unified Color System -->
    <link href="{% static 'css/unified-colors.css' %}" rel="stylesheet">
    <!-- HR Helper Custom CSS -->
    <link href="{% static 'css/hrhelper.css' %}" rel="stylesheet">
    
    <!-- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π favicon -->
    <link id="favicon" rel="icon" type="image/png" href="{% static 'img/logo-dark.png' %}">
    
    <!-- –°—Ç–∏–ª–∏ –¥–ª—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞ —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–µ–Ω—ã –≤ hrhelper.css -->
    
        {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            {% if not request.resolver_match.url_name == 'account_login' and not request.resolver_match.url_name == 'signup' and not request.resolver_match.url_name == 'password_reset' %}
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <div class="text-center mb-4">
                        <h4 class="text-white">
                            <i class="fas fa-sync-alt me-2"></i>
                HR Helper
                        </h4>
                        <p class="text-white-50 small">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è HR</p>
                    </div>
                    
                    <!-- –î–∏–Ω–∞–º–∏—á–Ω–æ–µ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –º–µ–Ω—é -->
                    {% render_sidebar_menu %}

                    <hr class="my-4" style="border-color: rgba(255,255,255,0.5); border-width: 1px;">
                    <ul class="nav flex-column mb-2">
                        <li class="nav-item">
                            <a class="nav-link{% if request.resolver_match.url_name == 'profile' %} active{% endif %}" href="{% url 'accounts:profile' %}">
                                <i class="fas fa-user me-2"></i>
                                –ü—Ä–æ—Ñ–∏–ª—å
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link{% if request.resolver_match.url_name == 'integrations' %} active{% endif %}" href="{% url 'accounts:integrations' %}">
                                <i class="fas fa-plug me-2"></i>
                                –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link{% if request.resolver_match.namespace == 'admin' %} active{% endif %}" href="{% url 'admin:index' %}">
                                <i class="fas fa-cog me-2"></i>
                                Admin-–ø–∞–Ω–µ–ª—å
                            </a>
                        </li>
                    </ul>
            </div>
            </nav>
            {% endif %}
            
            <!-- Main content -->
            <main class="{% if request.resolver_match.url_name == 'account_login' or request.resolver_match.url_name == 'signup' or request.resolver_match.url_name == 'password_reset' %}col-12{% else %}col-md-9 ms-sm-auto col-lg-10{% endif %} px-md-4 main-content">
                <div class="sticky-top d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    {% if not request.resolver_match.url_name == 'account_login' and not request.resolver_match.url_name == 'signup' and not request.resolver_match.url_name == 'password_reset' %}
                    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ -->
                    <div class="mx-3" style="margin-top: -8px; position: relative;">
                        <i class="fas fa-caret-square-right sidebar-toggle" id="sidebarToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å–∞–π–¥–±–∞—Ä"></i>
                        
                        <!-- –°—É–±–º–µ–Ω—é –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞) -->
                        <div class="sidebar-hover-menu" id="sidebarHoverMenu">
                            <div class="hover-menu-header">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-sync-alt me-2"></i>
                                    <strong>HR Helper</strong>
                                </div>
                                <button type="button" class="btn-expand-sidebar" id="expandSidebarBtn" aria-label="–†–∞—Å–∫—Ä—ã—Ç—å —Å–∞–π–¥–±–∞—Ä">
                                    <i class="fas fa-caret-square-right"></i>
                                </button>
                            </div>
                            <div class="hover-menu-content" id="hoverMenuContent">
                                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞ -->
                            </div>
                        </div>
                        
                    <h1 class="h2">
                            {% block page_title %}HR Helper{% endblock %}
                    </h1>
                    </div>
                    {% else %}
                    <div></div>
                    {% endif %}
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
                        <div class="btn-group me-3" role="group">
                            <button type="button" class="btn btn-outline-secondary theme-toggle" id="themeToggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                                <i class="fas fa-sun" id="themeIcon"></i>
                </button>
            </div>
            
                    {% if user.is_authenticated %}
                            <div class="btn-group me-3" role="group">
                                <a href="{% url 'accounts:profile' %}" class="btn btn-outline-primary" id="user-profile-btn">
                                    <i class="fas fa-user me-1"></i>
                                    <!-- –ü–æ–ª–Ω—ã–π email –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
                                    <span class="d-none d-md-inline user-full-text">{{ user.email|default:user.username }}</span>
                                    <!-- –¢–æ–ª—å–∫–æ –∏–º—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
                                    <span class="d-inline d-md-none user-short-text"></span>
                                </a>
                                <a href="{% url 'accounts:account_logout' %}" class="btn btn-outline-danger">
                                    <i class="fas fa-sign-out-alt me-1"></i>
                                    <!-- –¢–µ–∫—Å—Ç "–í—ã—Ö–æ–¥" —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
                                    <span class="d-none d-md-inline">–í—ã—Ö–æ–¥</span>
                                </a>
                            </div>
                    {% else %}
                            <a href="{% url 'accounts:account_login' %}" class="btn btn-primary me-3">
                                <i class="fas fa-sign-in-alt me-1"></i>
                                –í—Ö–æ–¥
                            </a>
                    {% endif %}
                        {% block page_actions %}{% endblock %}
            </div>
        </div>

                <!-- Content wrapper -->
                <div class="content-wrapper">
                    <!-- Messages -->
                    {% if messages and not request.resolver_match.url_name == 'chat_workflow' and not request.resolver_match.url_name == 'chat_workflow_session' %}
                        <div class="messages">
                            {% for message in messages %}
                            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                            {% endfor %}
                    </div>
                    {% endif %}

                    <!-- Page content -->
                     <div class="px-3">
                    {% block content %}{% endblock %}
                    </div>
                </div>
    </main>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <!-- jQuery -->
    <script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>
    
    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü -->
    <script>
        // –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
        function showLoading(element) {
            element.innerHTML = '<span class="loading-spinner"></span> –ó–∞–≥—Ä—É–∑–∫–∞...';
            element.disabled = true;
        }
        
        function hideLoading(element, originalText) {
            element.innerHTML = originalText;
            element.disabled = false;
        }
        
        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            const container = document.querySelector('.container-fluid');
            container.insertBefore(alertDiv, container.firstChild);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }
        
        // –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞
        document.addEventListener('DOMContentLoaded', function() {
            // === –ê–î–ê–ü–¢–ò–í–ù–û–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ===
            const userProfileBtn = document.getElementById('user-profile-btn');
            const userFullText = document.querySelector('.user-full-text');
            const userShortText = document.querySelector('.user-short-text');
            
            if (userProfileBtn && userFullText && userShortText) {
                const fullEmail = userFullText.textContent.trim();
                
                // –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–º—è –¥–æ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏ –∏–ª–∏ @
                let shortName = fullEmail;
                const dotIndex = fullEmail.indexOf('.');
                const atIndex = fullEmail.indexOf('@');
                
                if (dotIndex > 0 && (atIndex === -1 || dotIndex < atIndex)) {
                    shortName = fullEmail.substring(0, dotIndex);
                } else if (atIndex > 0) {
                    shortName = fullEmail.substring(0, atIndex);
                }
                
                // –ö–∞–ø–∏—Ç–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É
                shortName = shortName.charAt(0).toUpperCase() + shortName.slice(1).toLowerCase();
                
                userShortText.textContent = shortName;
                
                console.log('üë§ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', {
                    fullEmail,
                    shortName
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏–º—Å—è –ª–∏ –º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ì–ª–∞–≤–Ω–∞—è" (—á–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫)
            const isMainPage = window.location.pathname.includes('/google-oauth/chat/');
            
            // –°–Ω–∞—á–∞–ª–∞ —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –í–°–ï –º–µ–Ω—é
            const allCollapseElements = document.querySelectorAll('.sidebar .collapse');
            allCollapseElements.forEach(element => {
                element.classList.remove('show');
                const toggle = document.querySelector(`[data-bs-target="#${element.id}"]`);
                if (toggle) {
                    toggle.setAttribute('aria-expanded', 'false');
                }
            });
            
            // –ï—Å–ª–∏ –º—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (—á–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫), –Ω–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∏–∫–∞–∫–∏—Ö –º–µ–Ω—é
            if (isMainPage) {
                // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å active —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∫—Ä–æ–º–µ —Å–∞–º–æ–π –≥–ª–∞–≤–Ω–æ–π
                const allNavLinks = document.querySelectorAll('.sidebar .nav-link');
                allNavLinks.forEach(link => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    const href = link.getAttribute('href');
                    if (href && !href.includes('/google-oauth/chat/')) {
                        link.classList.remove('active');
                    }
                });
                console.log('üè† –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: —É–±—Ä–∞–Ω –∫–ª–∞—Å—Å active —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫—Ä–æ–º–µ –≥–ª–∞–≤–Ω–æ–π');
                return; // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –æ—Å—Ç–∞–≤–ª—è—è –≤—Å–µ –º–µ–Ω—é —Å–≤–µ—Ä–Ω—É—Ç—ã–º–∏
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é
            const activeMenuItems = document.querySelectorAll('.sidebar .nav-link.active');
            
            // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –º–µ–Ω—é
            activeMenuItems.forEach(function(activeItem) {
                let currentItem = activeItem.closest('.nav-item');
                
                // –ü–æ–¥–Ω–∏–º–∞–µ–º—Å—è –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –º–µ–Ω—é
                while (currentItem) {
                    const parentToggle = currentItem.querySelector('.menu-toggle');
                    if (parentToggle) {
                        const targetId = parentToggle.getAttribute('data-bs-target');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            targetElement.classList.add('show');
                            parentToggle.setAttribute('aria-expanded', 'true');
                        }
                    }
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
                    currentItem = currentItem.parentElement.closest('.nav-item');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–º—É –º–µ–Ω—é
            const sidebarToggles = document.querySelectorAll('.menu-toggle');
            
            sidebarToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    // –ï—Å–ª–∏ —ç—Ç–æ —Å—Å—ã–ª–∫–∞ —Å –ø–æ–¥–º–µ–Ω—é - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥
                    if (this.dataset.bsToggle === 'collapse') {
                        e.preventDefault();
                        
                        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
                        const currentNavItem = this.closest('.nav-item');
                        const currentLevel = currentNavItem.classList.contains('ms-1') ? 1 : 
                                           currentNavItem.classList.contains('ms-2') ? 2 : 0;
                        
                        // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –º–µ–Ω—é —Ç–æ–≥–æ –∂–µ —É—Ä–æ–≤–Ω—è
                        const allCollapses = document.querySelectorAll('.sidebar .collapse');
                        allCollapses.forEach(collapse => {
                            if (collapse.id !== this.dataset.bsTarget.replace('#', '')) {
                                const collapseToggle = document.querySelector(`[data-bs-target="#${collapse.id}"]`);
                                if (collapseToggle) {
                                    const collapseNavItem = collapseToggle.closest('.nav-item');
                                    const collapseLevel = collapseNavItem.classList.contains('ms-1') ? 1 : 
                                                        collapseNavItem.classList.contains('ms-2') ? 2 : 0;
                                    
                                    // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ —Ç–æ—Ç –∂–µ —É—Ä–æ–≤–µ–Ω—å
                                    if (collapseLevel === currentLevel) {
                                        collapse.classList.remove('show');
                                        collapseToggle.setAttribute('aria-expanded', 'false');
                                    }
                                }
                            }
                        });
                        
                        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –º–µ–Ω—é
                        const targetId = this.dataset.bsTarget.replace('#', '');
                        const targetElement = document.querySelector(this.dataset.bsTarget);
                        const isExpanded = this.getAttribute('aria-expanded') === 'true';
                        
                        if (isExpanded) {
                            // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
                            targetElement.classList.remove('show');
                            this.setAttribute('aria-expanded', 'false');
                        } else {
                            // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
                            targetElement.classList.add('show');
                            this.setAttribute('aria-expanded', 'true');
                        }
                    }
                });
            });
        });
        
        // –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –¢–ï–ú–´ - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ:
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è favicon –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
        function updateFavicon(theme) {
            const favicon = document.getElementById('favicon');
            if (favicon) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–º—ã
                if (theme === 'dark') {
                    // –¢–µ–º–Ω–∞—è —Ç–µ–º–∞: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–≤–µ—Ç–ª—ã–π –ª–æ–≥–æ—Ç–∏–ø
                    favicon.href = '{% static "img/logo-light.png" %}';
                } else {
                    // –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–º–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø
                    favicon.href = '{% static "img/logo-dark.png" %}';
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
        function toggleTheme() {
            console.log('üé® –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã...');
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            console.log('üìä –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞:', currentTheme);
            console.log('üéØ –ù–æ–≤–∞—è —Ç–µ–º–∞:', newTheme);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é —Ç–µ–º—É
            html.setAttribute('data-theme', newTheme);
            console.log('‚úÖ –ê—Ç—Ä–∏–±—É—Ç data-theme —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:', html.getAttribute('data-theme'));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
            setTimeout(() => {
                console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:', html.getAttribute('data-theme'));
            }, 100);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            const root = document.documentElement;
            if (newTheme === 'dark') {
                root.style.setProperty('--color-background', '#0d1117');
                root.style.setProperty('--color-surface', '#161b22');
                root.style.setProperty('--color-text', 'var(--color-luna-400)');
                root.style.setProperty('--color-primary', 'var(--color-pink-400)');
                console.log('üåô –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞');
            } else {
                root.style.setProperty('--color-background', '#ffffff');
                root.style.setProperty('--color-surface', '#ffffff');
                root.style.setProperty('--color-text', '#13343b');
                root.style.setProperty('--color-primary', 'var(--color-lime-500)'); // –¢–µ–ø–µ—Ä—å —Å–∏–Ω–∏–π
                console.log('‚òÄÔ∏è –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–µ—Ç–ª—ã–µ —Ü–≤–µ—Ç–∞ (–ª–∞–π–º —Ç–µ–ø–µ—Ä—å —Å–∏–Ω–∏–π)');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('theme', newTheme);
            console.log('üíæ –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage:', localStorage.getItem('theme'));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
            updateThemeIcon(newTheme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º favicon
            updateFavicon(newTheme);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showThemeNotification(newTheme);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ —Ç–µ–º—ã
        function updateThemeIcon(theme) {
            const themeIcon = document.getElementById('themeIcon');
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.className = 'fas fa-moon';
                } else {
                    themeIcon.className = 'fas fa-sun';
                }
                console.log('üé® –ò–∫–æ–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è —Ç–µ–º—ã:', theme);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–º–µ–Ω–µ —Ç–µ–º—ã
        function showThemeNotification(theme) {
            const themeName = theme === 'dark' ? '–¢—ë–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è';
            
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = 'alert alert-info alert-dismissible fade show position-fixed toast-notification';
            notification.style.cssText = 'bottom: 20px; left: 20px; z-index: 9999; transition: all 0.3s ease;';
            
            notification.innerHTML = `
                <i class="fas fa-${theme === 'dark' ? 'moon' : 'sun'} me-2"></i>
                –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ ${themeName} —Ç–µ–º—É
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
            const closeButton = notification.querySelector('.btn-close');
            closeButton.addEventListener('click', function() {
                // –£–¥–∞–ª—è–µ–º —Ç–æ—Å—Ç
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                    
                    // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–æ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã
                    const remainingToasts = document.querySelectorAll('.toast-notification');
                    let currentBottom = 20;
                    remainingToasts.forEach((toast) => {
                        toast.style.bottom = `${currentBottom}px`;
                        const toastHeight = toast.offsetHeight;
                        const margin = 10; // –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —Ç–æ—Å—Ç–∞–º–∏
                        currentBottom += toastHeight + margin;
                    });
                }
            });
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ—Å—Ç—ã
            const existingToasts = document.querySelectorAll('.toast-notification');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–Ω–∞—á–∞–ª–∞
            document.body.appendChild(notification);
            
            // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –Ω–æ–≤—ã–π —Ç–æ—Å—Ç –≤ —Å–∞–º–æ–º –Ω–∏–∑—É
            notification.style.bottom = '20px';
            
            // –ü–æ–¥–Ω–∏–º–∞–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ—Å—Ç—ã –≤–≤–µ—Ä—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã
            let currentBottom = 20;
            existingToasts.forEach((toast) => {
                const toastHeight = toast.offsetHeight;
                const margin = 10; // –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —Ç–æ—Å—Ç–∞–º–∏
                currentBottom += toastHeight + margin;
                toast.style.bottom = `${currentBottom}px`;
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(function() {
                if (notification.parentNode) {
                    // –£–¥–∞–ª—è–µ–º —Ç–æ—Å—Ç
                    notification.parentNode.removeChild(notification);
                    
                    // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–æ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã
                    const remainingToasts = document.querySelectorAll('.toast-notification');
                    let currentBottom = 20;
                    remainingToasts.forEach((toast) => {
                        toast.style.bottom = `${currentBottom}px`;
                        const toastHeight = toast.offsetHeight;
                        const margin = 10; // –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —Ç–æ—Å—Ç–∞–º–∏
                        currentBottom += toastHeight + margin;
                    });
                }
            }, 3000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö —Ç–æ—Å—Ç–æ–≤
        function clearAllToasts() {
            const existingToasts = document.querySelectorAll('.toast-notification');
            existingToasts.forEach(toast => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã...');
            
            // –û—á–∏—â–∞–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Ç–æ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            clearAllToasts();
            
            // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é
            const savedTheme = localStorage.getItem('theme');
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            const theme = savedTheme || systemTheme;
            
            console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Ç–µ–º–∞:', savedTheme);
            console.log('üñ•Ô∏è –°–∏—Å—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞:', systemTheme);
            console.log('üéØ –í—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞:', theme);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
            document.documentElement.setAttribute('data-theme', theme);
            console.log('‚úÖ –ê—Ç—Ä–∏–±—É—Ç data-theme —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', document.documentElement.getAttribute('data-theme'));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
            setTimeout(() => {
                console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 100ms:', document.documentElement.getAttribute('data-theme'));
            }, 100);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            const root = document.documentElement;
            if (theme === 'dark') {
                root.style.setProperty('--color-background', '#0d1117');
                root.style.setProperty('--color-surface', '#161b22');
                root.style.setProperty('--color-text', 'var(--color-luna-400)');
                root.style.setProperty('--color-primary', 'var(--color-pink-400)');
                console.log('üåô –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ');
            } else {
                root.style.setProperty('--color-background', '#ffffff');
                root.style.setProperty('--color-surface', '#ffffff');
                root.style.setProperty('--color-text', '#13343b');
                root.style.setProperty('--color-primary', 'var(--color-lime-500)'); // –¢–µ–ø–µ—Ä—å —Å–∏–Ω–∏–π
                console.log('‚òÄÔ∏è –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–µ—Ç–ª—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–ª–∞–π–º —Ç–µ–ø–µ—Ä—å —Å–∏–Ω–∏–π)');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
            updateThemeIcon(theme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º favicon
            updateFavicon(theme);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
            const themeToggle = document.getElementById('themeToggle');
            console.log('üîò –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –Ω–∞–π–¥–µ–Ω–∞:', themeToggle);
            if (themeToggle) {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
                themeToggle.removeEventListener('click', toggleTheme);
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                themeToggle.addEventListener('click', toggleTheme);
                console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω');
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
                console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–ª–∏–∫...');
                setTimeout(() => {
                    console.log('üéØ –ê—Ç—Ä–∏–±—É—Ç data-theme –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º:', document.documentElement.getAttribute('data-theme'));
                }, 500);
            } else {
                console.error('‚ùå –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
            }
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                if (!localStorage.getItem('theme')) {
                    const newTheme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', newTheme);
                    updateThemeIcon(newTheme);
                    updateFavicon(newTheme);
                }
            });
            
            console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
            
            // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            window.testThemeToggle = function() {
                console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã...');
                toggleTheme();
            };
        });
    </script>

    <!-- JavaScript –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ (—Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –≤ HTML)
        function getSidebarToggle() {
            const toggleBtn = document.getElementById('sidebarToggle');
            if (!toggleBtn) {
                console.warn('–ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
            return toggleBtn;
        }
        
        // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
        function createSidebarClose(sidebar) {
            const closeBtn = document.createElement('button');
            closeBtn.className = 'sidebar-close';
            closeBtn.innerHTML = '<i class="fas fa-caret-square-left"></i>';
            closeBtn.setAttribute('aria-label', '–ó–∞–∫—Ä—ã—Ç—å —Å–∞–π–¥–±–∞—Ä');
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
            if (window.innerWidth <= 992) {
                sidebar.appendChild(closeBtn);
            }
            return closeBtn;
        }
        
        // –°–æ–∑–¥–∞–µ–º overlay –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
        function createSidebarOverlay() {
            const overlay = document.createElement('div');
            overlay.className = 'sidebar-overlay';
            document.body.appendChild(overlay);
            return overlay;
        }
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–ª–∞—Å—Å—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
        function setupSidebarStructure() {
            const sidebar = document.querySelector('.col-md-3:first-child') || 
                           document.querySelector('.sidebar') ||
                           document.querySelector('[class*="sidebar"]');
                           
            const mainContent = document.querySelector('.col-md-9:last-child') || 
                               document.querySelector('.main-content') ||
                               document.querySelector('[class*="main"]');
            
            if (sidebar) {
                sidebar.classList.add('sidebar-container');
                
                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç
                if (window.innerWidth <= 992) {
                    sidebar.classList.add('hidden');
                }
            }
            
            if (mainContent) {
                mainContent.classList.add('main-content');
            }
            
            return { sidebar, mainContent };
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è hover –º–µ–Ω—é (–≤–µ—Ä—Å–∏—è 2.0 - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–∫—Ä—ã—Ç–∏—è)
        function initHoverMenu() {
            const sidebarToggle = document.getElementById('sidebarToggle');
            const hoverMenu = document.getElementById('sidebarHoverMenu');
            const hoverMenuContent = document.getElementById('hoverMenuContent');
            
            if (!sidebarToggle || !hoverMenu || !hoverMenuContent) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–±–∏–ª—å–Ω—ã–º
            function isMobileDevice() {
                return window.innerWidth <= 992; // Bootstrap lg breakpoint
            }
            
            // –ï—Å–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –æ—Ç–∫–ª—é—á–∞–µ–º hover –º–µ–Ω—é
            if (isMobileDevice()) {
                console.log('üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ - hover –º–µ–Ω—é –æ—Ç–∫–ª—é—á–µ–Ω–æ');
                hoverMenu.style.display = 'none';
                hoverMenu.style.pointerEvents = 'none';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', function() {
                if (isMobileDevice()) {
                    hoverMenu.style.display = 'none';
                    hoverMenu.style.pointerEvents = 'none';
                    console.log('üì± –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º - hover –º–µ–Ω—é –æ—Ç–∫–ª—é—á–µ–Ω–æ');
                } else {
                    hoverMenu.style.display = 'block';
                    hoverMenu.style.pointerEvents = 'auto';
                    console.log('üíª –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–Ω—ã–π —Ä–µ–∂–∏–º - hover –º–µ–Ω—é –≤–∫–ª—é—á–µ–Ω–æ');
                }
            });
            
            // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É hover –º–µ–Ω—é —Å –Ω—É–ª—è
            function createHoverMenuStructure() {
                // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                hoverMenuContent.innerHTML = '';
                
                // –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é
                const mainNav = document.createElement('ul');
                mainNav.className = 'nav flex-column hover-menu-nav';
                mainNav.style.margin = '0';
                mainNav.style.padding = '0';
                
                // –î–∞–Ω–Ω—ã–µ –º–µ–Ω—é (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
                const menuData = [
                    { title: '–ì–ª–∞–≤–Ω–∞—è', icon: 'hrhelper-logo', url: '/google-oauth/chat/' },
                    { title: 'Huntflow', icon: 'fas fa-users', url: '/huntflow/' },
                    { 
                        title: 'Google OAuth', 
                        icon: 'fab fa-google', 
                        url: '/google-oauth/',
                        submenu: [
                            { title: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å', icon: 'fas fa-calendar', url: '/google-oauth/calendar/' },
                            { title: '–ò–Ω–≤–∞–π—Ç—ã', icon: 'fas fa-envelope', url: '/google-oauth/invites/' },
                            { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Scorecard', icon: 'fas fa-folder-tree', url: '/google-oauth/invites/settings/' }
                        ]
                    },
                    { title: 'Gemini AI', icon: 'fas fa-robot', url: '/gemini/' },
                    { 
                        title: '–í–∞–∫–∞–Ω—Å–∏–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã', 
                        icon: 'fas fa-briefcase', 
                        url: '/vacancies/',
                        submenu: [
                            { title: '–î–∞—à–±–æ—Ä–¥', icon: 'fas fa-tachometer-alt', url: '/vacancies/' },
                            { title: '–í–∞–∫–∞–Ω—Å–∏–∏', icon: 'fas fa-list', url: '/vacancies/list/' },
                            { title: '–ó–∞—Ä–ø–ª–∞—Ç–Ω—ã–µ –≤–∏–ª–∫–∏', icon: 'fas fa-money-bill-wave', url: '/vacancies/salary-ranges/' },
                            { title: '–ì—Ä–µ–π–¥—ã, –Ω–∞–ª–æ–≥–∏ –∏ –∫—É—Ä—Å—ã', icon: 'fas fa-chart-line', url: '/finance/' },
                            { 
                                title: '–ë–µ–Ω—á–º–∞—Ä–∫–∏', 
                                icon: 'fas fa-chart-bar', 
                                url: '/finance/benchmarks/',
                                submenu: [
                                    { title: 'Dashboard', icon: 'fas fa-tachometer-alt', url: '/finance/benchmarks/' },
                                    { title: '–í—Å–µ –±–µ–Ω—á–º–∞—Ä–∫–∏', icon: 'fas fa-list', url: '/finance/benchmarks/list/' },
                                    { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', icon: 'fas fa-cog', url: '/finance/benchmarks/settings/' }
                                ]
                            }
                        ]
                    },
                    { 
                        title: '–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã', 
                        icon: 'fas fa-user-tie', 
                        url: '/interviewers/',
                        submenu: [
                            { title: '–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã', icon: 'fas fa-users', url: '/interviewers/list/' },
                            { title: '–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è', icon: 'fas fa-gavel', url: '/interviewers/rules/' }
                        ]
                    },
                    { 
                        title: 'ClickUp', 
                        icon: 'fas fa-tasks', 
                        url: '/clickup/',
                        submenu: [
                            { title: '–ì–ª–∞–≤–Ω–∞—è', icon: 'fas fa-tachometer-alt', url: '/clickup/' },
                            { title: '–°–ø–∏—Å–∫–∏', icon: 'fas fa-list', url: '/clickup/lists/' },
                            { title: '–ò–º–ø–æ—Ä—Ç', icon: 'fas fa-upload', url: '/clickup/import/' },
                            { title: '–õ–æ–≥–∏', icon: 'fas fa-history', url: '/clickup/logs/' },
                            { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', icon: 'fas fa-cog', url: '/clickup/settings/' }
                        ]
                    },
                    { 
                        title: 'Notion', 
                        icon: 'fas fa-sticky-note', 
                        url: '/notion/',
                        submenu: [
                            { title: '–ì–ª–∞–≤–Ω–∞—è', icon: 'fas fa-tachometer-alt', url: '/notion/' },
                            { title: '–°–ø–∏—Å–∫–∏', icon: 'fas fa-list', url: '/notion/lists/' },
                            { title: '–ò–º–ø–æ—Ä—Ç', icon: 'fas fa-upload', url: '/notion/import/' },
                            { title: '–õ–æ–≥–∏', icon: 'fas fa-history', url: '/notion/logs/' },
                            { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', icon: 'fas fa-cog', url: '/notion/settings/' }
                        ]
                    },
                    { 
                        title: 'Telegram', 
                        icon: 'fab fa-telegram', 
                        url: '/telegram/',
                        submenu: [
                            { title: '–ß–∞—Ç—ã', icon: 'fas fa-comments', url: '/telegram/chats/' },
                            { title: '–ö–æ–Ω—Ç–∞–∫—Ç—ã', icon: 'fas fa-address-book', url: '/telegram/contacts/' },
                            { title: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', icon: 'fas fa-robot', url: '/telegram/automation/' }
                        ]
                    }
                ];
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é
                menuData.forEach((item, index) => {
                    const menuItem = createMenuItem(item, index);
                    mainNav.appendChild(menuItem);
                });
                
                hoverMenuContent.appendChild(mainNav);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
                const separator = document.createElement('hr');
                separator.style.margin = '16px 0';
                separator.style.borderColor = 'var(--hr-border)';
                separator.style.opacity = '0.5';
                hoverMenuContent.appendChild(separator);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
                const additionalNav = document.createElement('ul');
                additionalNav.className = 'nav flex-column hover-menu-nav';
                additionalNav.style.margin = '0';
                additionalNav.style.padding = '0';
                
                const additionalItems = [
                    { title: '–ü—Ä–æ—Ñ–∏–ª—å', icon: 'fas fa-user', url: '/accounts/' },
                    { title: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏', icon: 'fas fa-plug', url: '/accounts/integrations/' },
                    { title: 'Admin-–ø–∞–Ω–µ–ª—å', icon: 'fas fa-cog', url: '/admin/' }
                ];
                
                additionalItems.forEach(item => {
                    const menuItem = createMenuItem(item);
                    additionalNav.appendChild(menuItem);
                });
                
                hoverMenuContent.appendChild(additionalNav);
                
                // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–µ–ª–æ—á–∫–∏
                removeDuplicateArrows();
                
                console.log('‚úÖ Hover –º–µ–Ω—é —Å–æ–∑–¥–∞–Ω–æ —Å –Ω—É–ª—è');
            }
            
            // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–µ–ª–æ—á–∫–∏
            function removeDuplicateArrows() {
                const links = hoverMenuContent.querySelectorAll('.nav-link');
                links.forEach(link => {
                    const arrows = link.querySelectorAll('.submenu-arrow');
                    if (arrows.length > 1) {
                        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–µ–ª–æ—á–∫—É
                        for (let i = 1; i < arrows.length; i++) {
                            arrows[i].remove();
                        }
                    }
                    
                    // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∫–ª–∞—Å—Å—ã chevron
                    const chevrons = link.querySelectorAll('.fa-chevron-down, .fa-chevron-up');
                    if (chevrons.length > 1) {
                        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–µ–ª–æ—á–∫—É
                        for (let i = 1; i < chevrons.length; i++) {
                            chevrons[i].remove();
                        }
                    }
                });
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —É–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Ç—Ä–µ–ª–æ—á–∫–∏ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–π –≤ –∫–∞–∂–¥–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ
                const allArrows = hoverMenuContent.querySelectorAll('[class*="chevron"]');
                const processedLinks = new Set();
                
                allArrows.forEach(arrow => {
                    const link = arrow.closest('.nav-link');
                    if (link && !processedLinks.has(link)) {
                        processedLinks.add(link);
                        const linkArrows = link.querySelectorAll('[class*="chevron"]');
                        if (linkArrows.length > 1) {
                            // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–µ–ª–æ—á–∫—É
                            for (let i = 1; i < linkArrows.length; i++) {
                                linkArrows[i].remove();
                            }
                        }
                    }
                });
                
                console.log('‚úÖ –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–µ–ª–æ—á–∫–∏ —É–¥–∞–ª–µ–Ω—ã');
            }
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –º–µ–Ω—é
            function createMenuItem(item, index = 0) {
                const li = document.createElement('li');
                li.className = 'nav-item';
                
                const hasSubmenu = item.submenu && item.submenu.length > 0;
                const submenuId = hasSubmenu ? `hover-submenu-${index}` : '';
                
                const a = document.createElement('a');
                a.className = 'nav-link';
                a.href = item.url;
                
                if (hasSubmenu) {
                    a.setAttribute('data-bs-toggle', 'collapse');
                    a.setAttribute('data-bs-target', `#${submenuId}`);
                    a.setAttribute('aria-expanded', 'false');
                    a.style.cursor = 'pointer';
                }
                
                // –ò–∫–æ–Ω–∫–∞
                if (item.icon === 'hrhelper-logo') {
                    const logo = document.createElement('div');
                    logo.className = 'hrhelper-logo-adaptive';
                    logo.style.width = '20px';
                    logo.style.height = '20px';
                    logo.style.marginRight = '12px';
                    logo.style.flexShrink = '0';
                    a.appendChild(logo);
                } else {
                    const icon = document.createElement('i');
                    icon.className = item.icon + ' me-2';
                    icon.style.width = '20px';
                    icon.style.textAlign = 'center';
                    icon.style.fontSize = '0.875rem';
                    icon.style.marginRight = '12px';
                    icon.style.flexShrink = '0';
                    a.appendChild(icon);
                }
                
                // –¢–µ–∫—Å—Ç
                const text = document.createTextNode(item.title);
                a.appendChild(text);
                
                // –°—Ç—Ä–µ–ª–æ—á–∫–∞ –¥–ª—è –ø–æ–¥–º–µ–Ω—é
                if (hasSubmenu) {
                    const arrow = document.createElement('i');
                    arrow.className = 'fas fa-chevron-down submenu-arrow ms-auto';
                    arrow.style.fontSize = '0.75rem';
                    arrow.style.transition = 'transform 0.2s ease';
                    a.appendChild(arrow);
                }
                
                li.appendChild(a);
                
                // –ü–æ–¥–º–µ–Ω—é
                if (hasSubmenu) {
                    const submenu = document.createElement('div');
                    submenu.className = 'collapse hover-submenu';
                    submenu.id = submenuId;
                    
                    const submenuUl = document.createElement('ul');
                    submenuUl.className = 'nav flex-column';
                    submenuUl.style.margin = '0';
                    submenuUl.style.padding = '0';
                    
                    item.submenu.forEach((subItem, subIndex) => {
                        const subMenuItem = createSubMenuItem(subItem, subIndex);
                        submenuUl.appendChild(subMenuItem);
                    });
                    
                    submenu.appendChild(submenuUl);
                    li.appendChild(submenu);
                }
                
                return li;
            }
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ–¥–º–µ–Ω—é
            function createSubMenuItem(item, index = 0, level = 1) {
                const li = document.createElement('li');
                li.className = 'nav-item';
                
                const hasSubmenu = item.submenu && item.submenu.length > 0;
                const submenuId = hasSubmenu ? `hover-submenu-${index}-${Math.random().toString(36).substr(2, 9)}` : '';
                
                const a = document.createElement('a');
                a.className = 'nav-link';
                a.href = item.url;
                
                // –û—Ç—Å—Ç—É–ø—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
                if (level === 1) {
                    a.style.padding = '10px 20px 10px 40px';
                } else {
                    a.style.padding = '8px 20px 8px 60px';
                }
                
                a.style.fontSize = level === 1 ? '0.8rem' : '0.75rem';
                a.style.color = 'var(--hr-text-muted)';
                a.style.borderLeft = '3px solid transparent';
                a.style.position = 'relative';
                
                if (hasSubmenu) {
                    a.setAttribute('data-bs-toggle', 'collapse');
                    a.setAttribute('data-bs-target', `#${submenuId}`);
                    a.setAttribute('aria-expanded', 'false');
                    a.style.cursor = 'pointer';
                }
                
                // –ò–∫–æ–Ω–∫–∞
                const icon = document.createElement('i');
                icon.className = item.icon;
                icon.style.width = '16px';
                icon.style.marginRight = '8px';
                icon.style.fontSize = '0.75rem';
                a.appendChild(icon);
                
                // –¢–µ–∫—Å—Ç
                const text = document.createTextNode(item.title);
                a.appendChild(text);
                
                // –°—Ç—Ä–µ–ª–æ—á–∫–∞ –¥–ª—è –ø–æ–¥–º–µ–Ω—é (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–º–µ–Ω—é)
                if (hasSubmenu) {
                    const arrow = document.createElement('i');
                    arrow.className = 'fas fa-chevron-down submenu-arrow ms-auto';
                    arrow.style.fontSize = '0.75rem';
                    arrow.style.transition = 'transform 0.2s ease';
                    a.appendChild(arrow);
                }
                
                li.appendChild(a);
                
                // –ü–æ–¥–º–µ–Ω—é
                if (hasSubmenu) {
                    const submenu = document.createElement('div');
                    submenu.className = 'collapse hover-submenu';
                    submenu.id = submenuId;
                    
                    const submenuUl = document.createElement('ul');
                    submenuUl.className = 'nav flex-column';
                    submenuUl.style.margin = '0';
                    submenuUl.style.padding = '0';
                    
                    item.submenu.forEach((subSubItem, subSubIndex) => {
                        const subSubMenuItem = createSubMenuItem(subSubItem, subSubIndex, level + 1);
                        submenuUl.appendChild(subSubMenuItem);
                    });
                    
                    submenu.appendChild(submenuUl);
                    li.appendChild(submenu);
                }
                
                return li;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è hover –º–µ–Ω—é
            function initHoverMenuEvents() {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                const existingElements = hoverMenuContent.querySelectorAll('[data-bs-toggle="collapse"]');
                existingElements.forEach(element => {
                    element.replaceWith(element.cloneNode(true));
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                const collapseElements = hoverMenuContent.querySelectorAll('[data-bs-toggle="collapse"]');
                collapseElements.forEach(element => {
                    element.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const targetId = this.getAttribute('data-bs-target');
                        const target = document.querySelector(targetId);
                        if (target) {
                            const isCollapsed = target.classList.contains('show');
                            const arrow = this.querySelector('.submenu-arrow');
                            
                            if (isCollapsed) {
                                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–º–µ–Ω—é
                                target.classList.remove('show');
                                this.setAttribute('aria-expanded', 'false');
                                
                                // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–µ–ª–æ—á–∫—É
                                if (arrow) {
                                    arrow.style.transform = 'rotate(0deg)';
                                }
                                
                                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–º–µ–Ω—é
                                const nestedSubmenus = target.querySelectorAll('.hover-submenu.show');
                                nestedSubmenus.forEach(nestedSubmenu => {
                                    nestedSubmenu.classList.remove('show');
                                    const nestedToggle = target.querySelector(`[data-bs-target="#${nestedSubmenu.id}"]`);
                                    if (nestedToggle) {
                                        nestedToggle.setAttribute('aria-expanded', 'false');
                                        const nestedArrow = nestedToggle.querySelector('.submenu-arrow');
                                        if (nestedArrow) {
                                            nestedArrow.style.transform = 'rotate(0deg)';
                                        }
                                    }
                                });
                            } else {
                                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–º–µ–Ω—é
                                target.classList.add('show');
                                this.setAttribute('aria-expanded', 'true');
                                
                                // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–µ–ª–æ—á–∫—É
                                if (arrow) {
                                    arrow.style.transform = 'rotate(180deg)';
                                }
                            }
                        }
                    });
                });
                
                console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è', collapseElements.length, '—ç–ª–µ–º–µ–Ω—Ç–æ–≤');
            }
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∞–π–¥–±–∞—Ä–æ–º
            function syncActiveStates() {
                const originalSidebar = document.querySelector('.sidebar');
                if (!originalSidebar) return;
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
                const currentPath = window.location.pathname;
                
                // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∞–π–¥–±–∞—Ä–µ
                const activeLinks = originalSidebar.querySelectorAll('.nav-link.active');
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ hover –º–µ–Ω—é
                const hoverLinks = hoverMenuContent.querySelectorAll('.nav-link');
                hoverLinks.forEach(link => {
                    const href = link.getAttribute('href');
                    if (href && currentPath.includes(href.replace(/\/$/, ''))) {
                        link.classList.add('active');
                        
                        // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–¥–º–µ–Ω—é, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –º–µ–Ω—é
                        const parentSubmenu = link.closest('.hover-submenu');
                        if (parentSubmenu) {
                            parentSubmenu.classList.add('show');
                            const parentToggle = hoverMenuContent.querySelector(`[data-bs-target="#${parentSubmenu.id}"]`);
                            if (parentToggle) {
                                parentToggle.setAttribute('aria-expanded', 'true');
                            }
                        }
                    } else {
                        link.classList.remove('active');
                    }
                });
                
                console.log('‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –ø–æ–¥–º–µ–Ω—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
            function closeAllSubmenus() {
                const allSubmenus = hoverMenuContent.querySelectorAll('.hover-submenu.show');
                allSubmenus.forEach(submenu => {
                    submenu.classList.remove('show');
                });
                
                const allToggles = hoverMenuContent.querySelectorAll('[data-bs-toggle="collapse"]');
                allToggles.forEach(toggle => {
                    toggle.setAttribute('aria-expanded', 'false');
                    const arrow = toggle.querySelector('.submenu-arrow');
                    if (arrow) {
                        arrow.style.transform = 'rotate(0deg)';
                    }
                });
                
                console.log('‚úÖ –í—Å–µ –ø–æ–¥–º–µ–Ω—é –∑–∞–∫—Ä—ã—Ç—ã');
            }
            
                // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                createHoverMenuStructure();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                initHoverMenuEvents();
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                syncActiveStates();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                window.hoverMenuTest = {
                    closeAll: closeAllSubmenus,
                    toggle: function(targetId) {
                        const target = document.querySelector(targetId);
                        if (target) {
                            target.classList.toggle('show');
                            console.log('–ü–æ–¥–º–µ–Ω—é', targetId, '–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ');
                        }
                    },
                    getOpenMenus: function() {
                        const openMenus = hoverMenuContent.querySelectorAll('.hover-submenu.show');
                        console.log('–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–¥–º–µ–Ω—é:', Array.from(openMenus).map(m => m.id));
                        return openMenus;
                    }
                };
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –ø–æ–¥–º–µ–Ω—é –≤ hover –º–µ–Ω—é
            function closeAllHoverSubmenus() {
                const hoverSubmenus = hoverMenuContent.querySelectorAll('.hover-submenu');
                hoverSubmenus.forEach(submenu => {
                    submenu.classList.remove('show');
                });
                
                const hoverToggles = hoverMenuContent.querySelectorAll('[data-bs-toggle="collapse"]');
                hoverToggles.forEach(toggle => {
                    toggle.setAttribute('aria-expanded', 'false');
                });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º hover –º–µ–Ω—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–∞–π–¥–±–∞—Ä–∞
            const observer = new MutationObserver(function(mutations) {
                let shouldUpdate = false;
                let shouldCheckVisibility = false;
                
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes') {
                        if (mutation.attributeName === 'class') {
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ show/hidden –Ω–∞ —Å–∞–π–¥–±–∞—Ä–µ
                            if (mutation.target.classList.contains('sidebar')) {
                                shouldCheckVisibility = true;
                            }
                            shouldUpdate = true;
                        } else if (mutation.attributeName === 'aria-expanded') {
                            shouldUpdate = true;
                        }
                    }
                });
                
                if (shouldCheckVisibility) {
                    checkSidebarVisibility();
                }
                
                if (shouldUpdate) {
                    setTimeout(() => {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –Ω—É–ª—è
                        syncActiveStates();
                    }, 100);
                }
            });
            
            // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ —Å–∞–π–¥–±–∞—Ä–µ
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                observer.observe(sidebar, {
                    attributes: true,
                    subtree: true,
                    attributeFilter: ['class', 'aria-expanded']
                });
            }
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            setTimeout(syncActiveStates, 200);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(() => {
                if (isSidebarVisible()) {
                    forceHideHoverMenu();
                    console.log('üöÄ –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä –≤–∏–¥–∏–º, —Å–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é');
                }
            }, 500);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞
            const mainToggleBtn = document.getElementById('sidebarToggle');
            if (mainToggleBtn) {
                mainToggleBtn.addEventListener('click', function() {
                    // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–∞–π–¥–±–∞—Ä —É—Å–ø–µ–ª –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è
                    setTimeout(() => {
                        checkSidebarVisibility();
                    }, 100);
                });
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å–∞–π–¥–±–∞—Ä–∞
            let lastSidebarState = null;
            
            function checkSidebarVisibility() {
                // –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                if (isMobileDevice()) {
                    return;
                }
                
                const isVisible = isSidebarVisible();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
                if (lastSidebarState !== isVisible) {
                    lastSidebarState = isVisible;
                    
                    if (isVisible) {
                        forceHideHoverMenu();
                        console.log('üîÑ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä —Å—Ç–∞–ª –≤–∏–¥–∏–º—ã–º - —Å–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é');
                    } else {
                        console.log('‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º hover –º–µ–Ω—é - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä —Å–∫—Ä—ã—Ç');
                    }
                }
            }
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è hover –º–µ–Ω—é
            function forceHideHoverMenu() {
                hoverMenu.classList.remove('show');
                hoverMenu.style.display = 'none';
                console.log('üö´ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 1000ms (—Ä–µ–∂–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ø–∞–º–∞)
            setInterval(checkSidebarVisibility, 1000);
            
            // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', checkSidebarVisibility);
            
            let hoverTimeout;
            
            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞
            function isSidebarVisible() {
                const sidebar = document.querySelector('.sidebar');
                if (!sidebar) return false;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å—ã show/hidden
                const isShow = sidebar.classList.contains('show');
                const isHidden = sidebar.classList.contains('hidden');
                const hasWidth = sidebar.offsetWidth > 50; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏
                const isInViewport = sidebar.getBoundingClientRect().width > 50;
                
                // –ù–∞ –¥–µ—Å–∫—Ç–æ–ø–µ (—à–∏—Ä–∏–Ω–∞ > 992px) —Å–∞–π–¥–±–∞—Ä –≤–∏–¥–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ —Å–∫—Ä—ã—Ç
                const isDesktop = window.innerWidth > 992;
                const isVisibleOnDesktop = isDesktop && !isHidden && hasWidth;
                
                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–∞–π–¥–±–∞—Ä –≤–∏–¥–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–ª–∞—Å—Å show
                const isVisibleOnMobile = !isDesktop && isShow && hasWidth;
                
                const isVisible = isVisibleOnDesktop || isVisibleOnMobile;
                
                return isVisible;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É
            sidebarToggle.addEventListener('mouseenter', function() {
                // –ù–µ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                if (isMobileDevice()) {
                    return;
                }
                
                clearTimeout(hoverTimeout);
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é
                hoverMenu.classList.remove('show');
                hoverMenu.style.display = 'none';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞
                if (!isSidebarVisible()) {
                    console.log('‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º hover –º–µ–Ω—é - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä —Å–∫—Ä—ã—Ç');
                    hoverMenu.style.display = 'block';
                    hoverMenu.classList.add('show');
                } else {
                    console.log('‚ùå –°–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä –≤–∏–¥–∏–º');
                    forceHideHoverMenu();
                }
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ —É—Ö–æ–¥–µ —Å –∫–Ω–æ–ø–∫–∏ (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
            sidebarToggle.addEventListener('mouseleave', function() {
                // –ù–µ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                if (isMobileDevice()) {
                    return;
                }
                
                hoverTimeout = setTimeout(() => {
                    hoverMenu.classList.remove('show');
                }, 100);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Å–∞–º–æ –º–µ–Ω—é
            hoverMenu.addEventListener('mouseenter', function() {
                // –ù–µ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                if (isMobileDevice()) {
                    return;
                }
                
                clearTimeout(hoverTimeout);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞
                if (!isSidebarVisible()) {
                    hoverMenu.classList.add('show');
                } else {
                    hoverMenu.classList.remove('show');
                }
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ —É—Ö–æ–¥–µ —Å –º–µ–Ω—é
            hoverMenu.addEventListener('mouseleave', function() {
                // –ù–µ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                if (isMobileDevice()) {
                    return;
                }
                
                hoverTimeout = setTimeout(() => {
                    hoverMenu.classList.remove('show');
                }, 100);
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(event) {
                if (!sidebarToggle.contains(event.target) && !hoverMenu.contains(event.target)) {
                    hoverMenu.classList.remove('show');
                }
            });
            
            // –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞
            const expandSidebarBtn = document.getElementById('expandSidebarBtn');
            if (expandSidebarBtn) {
                expandSidebarBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π–¥–±–∞—Ä
                    const mainSidebar = document.querySelector('.sidebar');
                    if (mainSidebar) {
                        mainSidebar.classList.remove('hidden');
                        mainSidebar.classList.add('show');
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        const mainContent = document.querySelector('.main-content');
                        if (mainContent) {
                            mainContent.classList.remove('sidebar-hidden');
                            mainContent.style.marginLeft = '240px';
                            mainContent.style.width = 'calc(100% - 240px)';
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞
                        const toggleBtn = document.getElementById('sidebarToggle');
                        if (toggleBtn) {
                            toggleBtn.className = 'fas fa-caret-square-left sidebar-toggle';
                        }
                        
                        console.log('üìÇ –†–∞—Å–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π–¥–±–∞—Ä–∞ –∏–∑ hover –º–µ–Ω—é');
                    }
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º hover –º–µ–Ω—é
                    forceHideHoverMenu();
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const { sidebar, mainContent } = setupSidebarStructure();
        
        if (!sidebar) {
            console.warn('–°–∞–π–¥–±–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º hover –º–µ–Ω—é
        initHoverMenu();
        
        // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        const toggleBtn = getSidebarToggle();
        const closeBtn = createSidebarClose(sidebar);
        const overlay = createSidebarOverlay();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–∞
        if (!toggleBtn) {
            console.warn('–ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∞');
            return;
        }
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
        let sidebarVisible = window.innerWidth > 992;
        let isToggling = false; // –§–ª–∞–≥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function initializeSidebarState() {
            const savedState = localStorage.getItem('sidebarState');
            if (savedState) {
                sidebarVisible = savedState === 'visible';
                console.log('üîç –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ –∏–∑ localStorage:', savedState);
            } else {
                console.log('üîç –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞:', window.innerWidth > 992 ? 'visible' : 'hidden');
            }
        }
        
        // –í—ã–∑—ã–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        initializeSidebarState();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞
        function toggleSidebar() {
            if (isToggling) return; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã
            isToggling = true;
            
            sidebarVisible = !sidebarVisible;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –≤ localStorage
            localStorage.setItem('sidebarState', sidebarVisible ? 'visible' : 'hidden');
            console.log('üíæ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:', sidebarVisible ? 'visible' : 'hidden');
            
            if (sidebarVisible) {
                sidebar.classList.remove('hidden');
                sidebar.classList.add('show');
                if (mainContent) {
                    mainContent.classList.remove('sidebar-hidden');
                    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª–∏
                    mainContent.style.marginLeft = '240px';
                    mainContent.style.width = 'calc(100% - 240px)';
                }
                
                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º overlay
                if (window.innerWidth <= 992) {
                    overlay.classList.add('show');
                }
                
                toggleBtn.className = 'fas fa-caret-square-left sidebar-toggle';
            } else {
                sidebar.classList.add('hidden');
                sidebar.classList.remove('show');
                if (mainContent) {
                    mainContent.classList.add('sidebar-hidden');
                    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª–∏
                    mainContent.style.marginLeft = '0';
                    mainContent.style.width = '100%';
                }
                
                overlay.classList.remove('show');
                toggleBtn.className = 'fas fa-caret-square-right sidebar-toggle';
            }
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º layout
            setTimeout(() => {
                // –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –±–µ–∑ –≤—ã–∑–æ–≤–∞ resize
                if (mainContent) {
                    mainContent.style.display = 'none';
                    mainContent.offsetHeight; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞
                    mainContent.style.display = '';
                }
                isToggling = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥
            }, 300);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è —Å–∞–π–¥–±–∞—Ä–∞
        function hideSidebar() {
            if (isToggling) return; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã
            isToggling = true;
            
            sidebarVisible = false;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –≤ localStorage
            localStorage.setItem('sidebarState', 'hidden');
            console.log('üíæ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: hidden');
            sidebar.classList.add('hidden');
            sidebar.classList.remove('show');
            if (mainContent) {
                mainContent.classList.add('sidebar-hidden');
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª–∏
                mainContent.style.marginLeft = '0';
                mainContent.style.width = '100%';
            }
            overlay.classList.remove('show');
            toggleBtn.className = 'fas fa-caret-square-right sidebar-toggle';
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º layout
            setTimeout(() => {
                // –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –±–µ–∑ –≤—ã–∑–æ–≤–∞ resize
                if (mainContent) {
                    mainContent.style.display = 'none';
                    mainContent.offsetHeight; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞
                    mainContent.style.display = '';
                }
                isToggling = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥
            }, 300);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞
        function restoreSidebarState() {
            const savedState = localStorage.getItem('sidebarState');
            if (savedState) {
                console.log('üîÑ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞:', savedState);
                
                if (savedState === 'hidden') {
                    sidebarVisible = false;
                    sidebar.classList.add('hidden');
                    sidebar.classList.remove('show');
                    if (mainContent) {
                        mainContent.classList.add('sidebar-hidden');
                        mainContent.style.marginLeft = '0';
                        mainContent.style.width = '100%';
                    }
                    overlay.classList.remove('show');
                    toggleBtn.className = 'fas fa-caret-square-right sidebar-toggle';
                } else if (savedState === 'visible') {
                    sidebarVisible = true;
                    sidebar.classList.remove('hidden');
                    sidebar.classList.add('show');
                    if (mainContent) {
                        mainContent.classList.remove('sidebar-hidden');
                        mainContent.style.marginLeft = '240px';
                        mainContent.style.width = 'calc(100% - 240px)';
                    }
                    toggleBtn.className = 'fas fa-caret-square-left sidebar-toggle';
                }
            } else {
                console.log('üÜï –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
            }
        }
        
        // –°–æ–±—ã—Ç–∏—è
        toggleBtn.addEventListener('click', toggleSidebar);
        closeBtn.addEventListener('click', hideSidebar);
        overlay.addEventListener('click', hideSidebar);
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        restoreSidebarState();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–∞–π–¥–±–∞—Ä–∞
        window.sidebarState = {
            reset: function() {
                localStorage.removeItem('sidebarState');
                console.log('üóëÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–æ');
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                location.reload();
            },
            get: function() {
                return localStorage.getItem('sidebarState');
            },
            set: function(state) {
                if (state === 'visible' || state === 'hidden') {
                    localStorage.setItem('sidebarState', state);
                    console.log('üíæ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:', state);
                } else {
                    console.warn('‚ùå –ù–µ–≤–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "visible" –∏–ª–∏ "hidden"');
                }
            }
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', function() {
            if (isToggling) return; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
            
            if (window.innerWidth > 992) {
                // –î–µ—Å–∫—Ç–æ–ø: –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
                const savedState = localStorage.getItem('sidebarState');
                if (savedState === 'hidden') {
                    sidebar.classList.add('hidden');
                    sidebar.classList.remove('show');
                    if (mainContent) {
                        mainContent.classList.add('sidebar-hidden');
                        mainContent.style.marginLeft = '0';
                        mainContent.style.width = '100%';
                    }
                    sidebarVisible = false;
                    toggleBtn.className = 'fas fa-caret-square-right sidebar-toggle';
                } else {
                    sidebar.classList.remove('hidden');
                    sidebar.classList.add('show');
                    if (mainContent) {
                        mainContent.classList.remove('sidebar-hidden');
                        mainContent.style.marginLeft = '240px';
                        mainContent.style.width = 'calc(100% - 240px)';
                    }
                    sidebarVisible = true;
                    toggleBtn.className = 'fas fa-caret-square-left sidebar-toggle';
                }
                overlay.classList.remove('show');
                
                // –£–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ
                const existingCloseBtn = sidebar.querySelector('.sidebar-close');
                if (existingCloseBtn) {
                    existingCloseBtn.remove();
                }
            } else {
                // –ú–æ–±–∏–ª—å–Ω—ã–π: —Å–∫—Ä—ã–≤–∞–µ–º —Å–∞–π–¥–±–∞—Ä
                if (sidebarVisible) {
                    overlay.classList.add('show');
                    sidebar.classList.add('show');
                } else {
                    sidebar.classList.add('hidden');
                    sidebar.classList.remove('show');
                    overlay.classList.remove('show');
                }
                
                if (mainContent) {
                    mainContent.classList.add('sidebar-hidden');
                    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª–∏
                    mainContent.style.marginLeft = '0';
                    mainContent.style.width = '100%';
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
                const existingCloseBtn = sidebar.querySelector('.sidebar-close');
                if (!existingCloseBtn) {
                    const newCloseBtn = createSidebarClose(sidebar);
                    newCloseBtn.addEventListener('click', hideSidebar);
                }
            }
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        if (window.innerWidth <= 992) {
            hideSidebar();
        } else {
            toggleBtn.className = 'fas fa-caret-square-left sidebar-toggle';
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
            if (mainContent) {
                mainContent.style.marginLeft = '240px';
                mainContent.style.width = 'calc(100% - 240px)';
            }
        }
    });
    </script>

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü -->
    {% block extra_js %}
    {% endblock %}
</body>
</html>

