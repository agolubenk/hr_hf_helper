{% extends 'common/base.html' %}
{% load static %}
{% load common_filters %}

{% block title %}–ë–µ–Ω—á–º–∞—Ä–∫–∏ –∑–∞—Ä–ø–ª–∞—Ç{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/finance.css' %}">
<style>
.benchmark-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    margin-bottom: var(--space-12);
    transition: all var(--duration-normal) var(--ease-standard);
}

.benchmark-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.benchmark-type {
    display: inline-flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-4) var(--space-8);
    border-radius: var(--radius-full);
    font-size: 0.875rem;
    font-weight: 500;
}

.benchmark-type.candidate {
    background: rgba(40, 167, 69, 0.1);
    color: var(--color-success);
}

.benchmark-type.vacancy {
    background: rgba(0, 123, 255, 0.1);
    color: var(--color-primary);
}

.benchmark-amount {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-text);
}

.benchmark-amount-small {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--color-text);
}

.benchmark-location {
    color: var(--color-text-secondary);
    font-size: 0.875rem;
}

.filters-section {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    margin-bottom: var(--space-16);
}

.stats-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-12);
    margin-bottom: var(--space-16);
}

.stat-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    text-align: center;
}

.stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-primary);
}

.stat-label {
    color: var(--color-text-secondary);
    font-size: 0.875rem;
    margin-top: var(--space-4);
}

[data-theme="dark"] .benchmark-card {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .benchmark-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .filters-section {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .stat-card {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–ª–ª–∞–ø—Å–∏—Ä—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ */
.collapsible-column {
    display: none;
}

.collapsible-column.show {
    display: table-cell;
}

.collapsible-toggle {
    cursor: pointer;
    user-select: none;
    padding: 8px 12px;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    transition: all var(--duration-normal) var(--ease-standard);
}

.collapsible-toggle:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

.collapsible-toggle.active {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

/* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã */
.table-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

.table-container table {
    min-width: 800px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ç–∞–±–ª–∏—Ü—ã */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π */
.additional-field {
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    position: relative;
    display: inline-block;
}

.additional-field:hover {
    overflow: visible;
    white-space: normal;
    background: var(--color-surface);
    padding: 4px;
    border-radius: var(--radius-sm);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    max-width: 100%;
    word-wrap: break-word;
    border: 1px solid var(--color-border);
}

/* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º, —á—Ç–æ —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ä—è–¥—É */
.table td {
    vertical-align: middle;
    white-space: nowrap;
    position: relative;
    max-width: 200px;
    overflow: hidden;
}

/* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ —è—á–µ–π–∫–∞—Ö */
.table td .additional-field {
    display: inline-block;
    vertical-align: middle;
    position: relative;
}

/* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º, —á—Ç–æ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–∑–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü—ã */
.table tbody tr:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã */
.table-container {
    position: relative;
}

.table tbody tr {
    position: relative;
}

/* –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É —è—á–µ–µ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ */
.table td.collapsible-column {
    max-width: 180px;
    min-width: 120px;
    overflow: hidden;
    position: relative;
}

/* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —è—á–µ–µ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
.table td.collapsible-column:hover {
    overflow: visible;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è badge –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è—Ö */
.additional-field .badge {
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* –¶–≤–µ—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã */
.badge.work-format-office {
    background-color: #007bff !important; /* –°–∏–Ω–∏–π –¥–ª—è –æ—Ñ–∏—Å–∞ */
    color: white !important;
}

.badge.work-format-hybrid {
    background-color: #28a745 !important; /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≥–∏–±—Ä–∏–¥–∞ */
    color: white !important;
}

.badge.work-format-remote {
    background-color: #fd7e14 !important; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∫–∏ */
    color: white !important;
}

.badge.work-format-all-world {
    background-color: #6f42c1 !important; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è all world */
    color: white !important;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Bootstrap */
.additional-field .badge.work-format-office {
    background-color: #007bff !important;
    color: white !important;
}

.additional-field .badge.work-format-hybrid {
    background-color: #28a745 !important;
    color: white !important;
}

.additional-field .badge.work-format-remote {
    background-color: #fd7e14 !important;
    color: white !important;
}

.additional-field .badge.work-format-all-world {
    background-color: #6f42c1 !important;
    color: white !important;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
[data-theme="dark"] .additional-field:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
[data-theme="dark"] .badge.work-format-office {
    background-color: #0056b3 !important; /* –¢–µ–º–Ω–µ–µ —Å–∏–Ω–∏–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
    color: white !important;
}

[data-theme="dark"] .badge.work-format-hybrid {
    background-color: #1e7e34 !important; /* –¢–µ–º–Ω–µ–µ –∑–µ–ª–µ–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
    color: white !important;
}

[data-theme="dark"] .badge.work-format-remote {
    background-color: #e55a00 !important; /* –¢–µ–º–Ω–µ–µ –æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
    color: white !important;
}

[data-theme="dark"] .badge.work-format-all-world {
    background-color: #5a2d91 !important; /* –¢–µ–º–Ω–µ–µ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
    color: white !important;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
[data-theme="dark"] .additional-field .badge.work-format-office {
    background-color: #0056b3 !important;
    color: white !important;
}

[data-theme="dark"] .additional-field .badge.work-format-hybrid {
    background-color: #1e7e34 !important;
    color: white !important;
}

[data-theme="dark"] .additional-field .badge.work-format-remote {
    background-color: #e55a00 !important;
    color: white !important;
}

[data-theme="dark"] .additional-field .badge.work-format-all-world {
    background-color: #5a2d91 !important;
    color: white !important;
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'finance:dashboard' %}">–§–∏–Ω–∞–Ω—Å—ã</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'finance:benchmarks_dashboard' %}">–ë–µ–Ω—á–º–∞—Ä–∫–∏</a></li>
                    <li class="breadcrumb-item active" aria-current="page">–°–ø–∏—Å–æ–∫</li>
                </ol>
            </nav>

            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="h3 mb-1">–ë–µ–Ω—á–º–∞—Ä–∫–∏ –∑–∞—Ä–ø–ª–∞—Ç</h1>
                    <p class="text-muted mb-0">–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –∑–∞—Ä–ø–ª–∞—Ç –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º –∏ –≥—Ä–µ–π–¥–∞–º</p>
                </div>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createBenchmarkModal">
                    <i class="fas fa-plus me-2"></i>–î–æ–±–∞–≤–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫
                </button>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-number">{{ total_count }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ candidate_count }}</div>
                    <div class="stat-label">–ö–∞–Ω–¥–∏–¥–∞—Ç—ã</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ vacancy_count }}</div>
                    <div class="stat-label">–í–∞–∫–∞–Ω—Å–∏–∏</div>
                </div>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="filters-section">
                <form method="get" class="row g-3">
                    <div class="col-md-3">
                        <label for="search" class="form-label">–ü–æ–∏—Å–∫</label>
                        <input type="text" class="form-control" id="search" name="search" 
                               value="{{ search_query }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≤–∞–∫–∞–Ω—Å–∏–∏, –≥—Ä–µ–π–¥—É, –ª–æ–∫–∞—Ü–∏–∏...">
                    </div>
                    <div class="col-md-2">
                        <label for="type" class="form-label">–¢–∏–ø</label>
                        <select class="form-select" id="type" name="type">
                            <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                            {% for value, label in benchmark_types %}
                                <option value="{{ value }}" {% if type_filter == value %}selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label for="vacancy" class="form-label">–í–∞–∫–∞–Ω—Å–∏—è</label>
                        <select class="form-select" id="vacancy" name="vacancy">
                            <option value="">–í—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏</option>
                            {% for vacancy in vacancies %}
                                <option value="{{ vacancy.id }}" {% if vacancy_filter == vacancy.id|stringformat:"s" %}selected{% endif %}>{{ vacancy.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label for="grade" class="form-label">–ì—Ä–µ–π–¥</label>
                        <select class="form-select" id="grade" name="grade">
                            <option value="">–í—Å–µ –≥—Ä–µ–π–¥—ã</option>
                            {% for grade in grades %}
                                <option value="{{ grade.id }}" {% if grade_filter == grade.id|stringformat:"s" %}selected{% endif %}>{{ grade.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label for="is_active" class="form-label">–°—Ç–∞—Ç—É—Å</label>
                        <select class="form-select" id="is_active" name="is_active">
                            <option value="">–í—Å–µ</option>
                            <option value="true" {% if status_filter == "true" %}selected{% endif %}>–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                            <option value="false" {% if status_filter == "false" %}selected{% endif %}>–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
                        </select>
                    </div>
                    <div class="col-md-1">
                        <label class="form-label">&nbsp;</label>
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-search"></i>
                            </button>
                            <a href="{% url 'finance:benchmarks_list' %}" class="btn btn-outline-secondary">
                                <i class="fas fa-times"></i>
                            </a>
                        </div>
                    </div>
                </form>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π -->
            {% if enabled_fields|length > 5 %}
            <div class="mb-3">
                <div class="d-flex flex-wrap gap-2">
                    <span class="text-muted me-2">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:</span>
                    {% if 'work_format' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="work_format">–§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã</button>
                    {% endif %}
                    {% if 'compensation' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="compensation">–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏</button>
                    {% endif %}
                    {% if 'benefits' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="benefits">–ë–µ–Ω–µ—Ñ–∏—Ç—ã</button>
                    {% endif %}
                    {% if 'development' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="development">–†–∞–∑–≤–∏—Ç–∏–µ</button>
                    {% endif %}
                    {% if 'technologies' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="technologies">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</button>
                    {% endif %}
                    {% if 'domain' in enabled_fields %}
                    <button class="collapsible-toggle" data-column="domain">–î–æ–º–µ–Ω</button>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!-- –°–ø–∏—Å–æ–∫ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ -->
            <div class="card">
                <div class="card-body">
                    {% if page_obj %}
                        <div class="table-responsive table-container">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>–¢–∏–ø</th>
                                        <th>–í–∞–∫–∞–Ω—Å–∏—è</th>
                                        <th>–ì—Ä–µ–π–¥</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–õ–æ–∫–∞—Ü–∏—è</th>
                                        {% if 'work_format' in enabled_fields %}
                                        <th class="collapsible-column" data-column="work_format">–§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã</th>
                                        {% endif %}
                                        {% if 'compensation' in enabled_fields %}
                                        <th class="collapsible-column" data-column="compensation">–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏</th>
                                        {% endif %}
                                        {% if 'benefits' in enabled_fields %}
                                        <th class="collapsible-column" data-column="benefits">–ë–µ–Ω–µ—Ñ–∏—Ç—ã</th>
                                        {% endif %}
                                        {% if 'development' in enabled_fields %}
                                        <th class="collapsible-column" data-column="development">–†–∞–∑–≤–∏—Ç–∏–µ</th>
                                        {% endif %}
                                        {% if 'technologies' in enabled_fields %}
                                        <th class="collapsible-column" data-column="technologies">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</th>
                                        {% endif %}
                                        {% if 'domain' in enabled_fields %}
                                        <th class="collapsible-column" data-column="domain">–î–æ–º–µ–Ω</th>
                                        {% endif %}
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for benchmark in page_obj %}
                                    <tr>
                                        <td>
                                            <span class="benchmark-type {{ benchmark.type }}" title="{{ benchmark.get_type_display }}">
                                                <i class="{{ benchmark.type_icon }}"></i>
                                            </span>
                                        </td>
                                        <td>
                                            <strong>{{ benchmark.vacancy.name }}</strong>
                                        </td>
                                        <td>
                                            <span class="badge bg-primary">{{ benchmark.grade.name }}</span>
                                        </td>
                                        <td>
                                            <span class="benchmark-amount-small">{{ benchmark.get_salary_display }}</span>
                                        </td>
                                        <td>
                                            <div class="benchmark-location">
                                                <i class="fas fa-map-marker-alt me-1"></i>{{ benchmark.location|get_country }}
                                            </div>
                                        </td>
                                        {% if 'work_format' in enabled_fields %}
                                        <td class="collapsible-column" data-column="work_format">
                                            {% if benchmark.work_format %}
                                                <span class="additional-field" title="{{ benchmark.get_work_format_display }}">
                                                    {% if benchmark.work_format == '–æ—Ñ–∏—Å' %}
                                                        <span class="badge work-format-office">{{ benchmark.get_work_format_display }}</span>
                                                    {% elif benchmark.work_format == '–≥–∏–±—Ä–∏–¥' %}
                                                        <span class="badge work-format-hybrid">{{ benchmark.get_work_format_display }}</span>
                                                    {% elif benchmark.work_format == '—É–¥–∞–ª–µ–Ω–∫–∞' %}
                                                        <span class="badge work-format-remote">{{ benchmark.get_work_format_display }}</span>
                                                    {% elif benchmark.work_format == 'all world' %}
                                                        <span class="badge work-format-all-world">{{ benchmark.get_work_format_display }}</span>
                                                    {% else %}
                                                        <span class="badge bg-secondary">{{ benchmark.get_work_format_display }}</span>
                                                    {% endif %}
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        {% if 'compensation' in enabled_fields %}
                                        <td class="collapsible-column" data-column="compensation">
                                            {% if benchmark.compensation %}
                                                <span class="additional-field" title="{{ benchmark.compensation }}">
                                                    <small class="text-muted">{{ benchmark.compensation }}</small>
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        {% if 'benefits' in enabled_fields %}
                                        <td class="collapsible-column" data-column="benefits">
                                            {% if benchmark.benefits %}
                                                <span class="additional-field" title="{{ benchmark.benefits }}">
                                                    <small class="text-muted">{{ benchmark.benefits }}</small>
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        {% if 'development' in enabled_fields %}
                                        <td class="collapsible-column" data-column="development">
                                            {% if benchmark.development %}
                                                <span class="additional-field" title="{{ benchmark.development }}">
                                                    <small class="text-muted">{{ benchmark.development }}</small>
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        {% if 'technologies' in enabled_fields %}
                                        <td class="collapsible-column" data-column="technologies">
                                            {% if benchmark.technologies %}
                                                <span class="additional-field" title="{{ benchmark.technologies }}">
                                                    <small class="text-muted">{{ benchmark.technologies }}</small>
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        {% if 'domain' in enabled_fields %}
                                        <td class="collapsible-column" data-column="domain">
                                            {% if benchmark.domain %}
                                                <span class="additional-field" title="{{ benchmark.domain }}">
                                                    <small class="text-muted">{{ benchmark.domain }}</small>
                                                </span>
                                            {% else %}
                                                <span class="text-muted">‚Äî</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                        <td>
                                            <small class="text-muted">
                                                <i class="fas fa-calendar me-1"></i>{{ benchmark.date_added|date:"d.m.Y" }}
                                            </small>
                                        </td>
                                        <td>
                                            {% if benchmark.is_active %}
                                                <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                                            {% else %}
                                                <span class="badge bg-secondary">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                {% if benchmark.hh_vacancy_id %}
                                                <a href="https://hh.ru/vacancy/{{ benchmark.hh_vacancy_id }}" 
                                                   target="_blank" 
                                                   rel="noopener noreferrer"
                                                   class="btn btn-outline-success" title="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ hh.ru">
                                                    <i class="fas fa-external-link-alt"></i>
                                                </a>
                                                {% endif %}
                                                <a href="{% url 'finance:benchmark_detail' benchmark.pk %}" 
                                                   class="btn btn-outline-primary" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">
                                                    <i class="fas fa-eye"></i>
                                                </a>
                                                <a href="{% url 'finance:benchmark_edit' benchmark.pk %}" 
                                                   class="btn btn-outline-secondary" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <button class="btn btn-outline-danger delete-benchmark-btn" 
                                                        data-benchmark-id="{{ benchmark.pk }}"
                                                        title="–£–¥–∞–ª–∏—Ç—å">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="text-center py-5">
                            <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">–ë–µ–Ω—á–º–∞—Ä–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
                            <p class="text-muted">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –±–µ–Ω—á–º–∞—Ä–∫</p>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createBenchmarkModal">
                                <i class="fas fa-plus me-2"></i>–î–æ–±–∞–≤–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫
                            </button>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
            {% if page_obj.has_other_pages %}
            <nav aria-label="–ü–∞–≥–∏–Ω–∞—Ü–∏—è –±–µ–Ω—á–º–∞—Ä–∫–æ–≤">
                <ul class="pagination justify-content-center">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page=1">–ü–µ—Ä–≤–∞—è</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
                        </li>
                    {% endif %}
                    
                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <li class="page-item active">
                                <span class="page-link">{{ num }}</span>
                            </li>
                        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                            <li class="page-item">
                                <a class="page-link" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ num }}">{{ num }}</a>
                            </li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">–°–ª–µ–¥—É—é—â–∞—è</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.paginator.num_pages }}">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
            {% endif %}
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–Ω—á–º–∞—Ä–∫–∞ -->
<div class="modal fade" id="createBenchmarkModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="createBenchmarkForm">
                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="createType" class="form-label">–¢–∏–ø –±–µ–Ω—á–º–∞—Ä–∫–∞ *</label>
                            <select class="form-select" id="createType" name="type" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                {% for value, label in benchmark_types %}
                                    <option value="{{ value }}">{{ label }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="createSalaryFrom" class="form-label">–ó–∞—Ä–ø–ª–∞—Ç–∞ –æ—Ç (USD) *</label>
                            <input type="number" class="form-control" id="createSalaryFrom" name="salary_from" 
                                   step="0.01" min="0" required placeholder="3000.00">
                        </div>
                        <div class="col-md-6">
                            <label for="createSalaryTo" class="form-label">–ó–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ (USD)</label>
                            <input type="number" class="form-control" id="createSalaryTo" name="salary_to" 
                                   step="0.01" min="0" placeholder="5000.00">
                            <div class="form-text">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏–ª–∏ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—É–º–º–∞</div>
                        </div>
                        <div class="col-md-6">
                            <label for="createVacancy" class="form-label">–í–∞–∫–∞–Ω—Å–∏—è *</label>
                            <select class="form-select" id="createVacancy" name="vacancy_id" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–∫–∞–Ω—Å–∏—é</option>
                                {% for vacancy in vacancies %}
                                    <option value="{{ vacancy.id }}">{{ vacancy.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="createGrade" class="form-label">–ì—Ä–µ–π–¥ *</label>
                            <select class="form-select" id="createGrade" name="grade_id" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–µ–π–¥</option>
                                {% for grade in grades %}
                                    <option value="{{ grade.id }}">{{ grade.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-12">
                            <label for="createLocation" class="form-label">–õ–æ–∫–∞—Ü–∏—è *</label>
                            <input type="text" class="form-control" id="createLocation" name="location" 
                                   required placeholder="–ú–∏–Ω—Å–∫, –ë–µ–ª–∞—Ä—É—Å—å">
                        </div>
                        <div class="col-12">
                            <label for="createNotes" class="form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                            <textarea class="form-control" id="createNotes" name="notes" rows="3" 
                                      placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–µ–Ω—á–º–∞—Ä–∫–µ..."></textarea>
                        </div>
                        
                        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
                        {% if 'work_format' in enabled_fields %}
                        <div class="col-md-6">
                            <label for="createWorkFormat" class="form-label">–§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã</label>
                            <select class="form-select" id="createWorkFormat" name="work_format">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç</option>
                                <option value="–æ—Ñ–∏—Å">–û—Ñ–∏—Å</option>
                                <option value="–≥–∏–±—Ä–∏–¥">–ì–∏–±—Ä–∏–¥</option>
                                <option value="—É–¥–∞–ª–µ–Ω–∫–∞">–£–¥–∞–ª–µ–Ω–∫–∞</option>
                                <option value="all world">All World</option>
                            </select>
                        </div>
                        {% endif %}
                        
                        {% if 'compensation' in enabled_fields %}
                        <div class="col-12">
                            <label for="createCompensation" class="form-label">–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏</label>
                            <textarea class="form-control" id="createCompensation" name="compensation" rows="2" 
                                      placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã..."></textarea>
                        </div>
                        {% endif %}
                        
                        {% if 'benefits' in enabled_fields %}
                        <div class="col-12">
                            <label for="createBenefits" class="form-label">–ë–µ–Ω–µ—Ñ–∏—Ç—ã</label>
                            <textarea class="form-control" id="createBenefits" name="benefits" rows="2" 
                                      placeholder="–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ª—å–≥–æ—Ç—ã –∏ –±–µ–Ω–µ—Ñ–∏—Ç—ã..."></textarea>
                        </div>
                        {% endif %}
                        
                        {% if 'development' in enabled_fields %}
                        <div class="col-12">
                            <label for="createDevelopment" class="form-label">–†–∞–∑–≤–∏—Ç–∏–µ/–æ–±—É—á–µ–Ω–∏–µ</label>
                            <textarea class="form-control" id="createDevelopment" name="development" rows="2" 
                                      placeholder="–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è..."></textarea>
                        </div>
                        {% endif %}
                        
                        {% if 'technologies' in enabled_fields %}
                        <div class="col-12">
                            <label for="createTechnologies" class="form-label">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</label>
                            <textarea class="form-control" id="createTechnologies" name="technologies" rows="2" 
                                      placeholder="–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Å—Ç–µ–∫–∏..."></textarea>
                        </div>
                        {% endif %}
                        
                        {% if 'domain' in enabled_fields %}
                        <div class="col-12">
                            <label for="createDomain" class="form-label">–î–æ–º–µ–Ω</label>
                            <input type="text" class="form-control" id="createDomain" name="domain" 
                                   placeholder="–î–æ–º–µ–Ω –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏">
                        </div>
                        {% endif %}
                        
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="createIsActive" name="is_active" checked>
                                <label class="form-check-label" for="createIsActive">
                                    –ê–∫—Ç–∏–≤–µ–Ω
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –±–µ–Ω—á–º–∞—Ä–∫</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–Ω—á–º–∞—Ä–∫–∞
document.getElementById('createBenchmarkForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());
    
    try {
        const response = await fetch('{% url "finance:benchmark_create" %}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.success) {
            showAlert('success', result.message);
            bootstrap.Modal.getInstance(document.getElementById('createBenchmarkModal')).hide();
            this.reset();
            location.reload();
        } else {
            showAlert('error', result.message);
        }
    } catch (error) {
        showAlert('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–µ–Ω—á–º–∞—Ä–∫–∞');
    }
});

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
function editBenchmark(id) {
    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    showAlert('info', '–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞');
}

function deleteBenchmark(id) {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –±–µ–Ω—á–º–∞—Ä–∫?')) {
        fetch(`/finance/benchmarks/${id}/delete/`, {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                showAlert('success', result.message);
                location.reload();
            } else {
                showAlert('error', result.message);
            }
        })
        .catch(error => {
            showAlert('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±–µ–Ω—á–º–∞—Ä–∫–∞');
        });
    }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showAlert(type, message) {
    const alertClass = type === 'success' ? 'alert-success' : 
                      type === 'error' ? 'alert-danger' : 'alert-info';
    
    const alert = document.createElement('div');
    alert.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
    alert.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    alert.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(alert);
    
    setTimeout(() => {
        if (alert.parentNode) {
            alert.parentNode.removeChild(alert);
        }
    }, 5000);
}
// –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã –¥–ª—è Huntflow
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
function toggleTheme() {
    console.log('üîÑ Huntflow: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã...');
    const html = document.documentElement;
    const currentTheme = html.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    console.log('üìä Huntflow: –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞:', currentTheme);
    console.log('üéØ Huntflow: –ù–æ–≤–∞—è —Ç–µ–º–∞:', newTheme);
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é —Ç–µ–º—É
    html.setAttribute('data-theme', newTheme);
    console.log('‚úÖ Huntflow: –ê—Ç—Ä–∏–±—É—Ç data-theme —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:', html.getAttribute('data-theme'));
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    const root = document.documentElement;
    if (newTheme === 'dark') {
        root.style.setProperty('--color-background', '#0d1117');
        root.style.setProperty('--color-surface', '#161b22');
        root.style.setProperty('--color-text', 'var(--color-luna-400)');
        root.style.setProperty('--color-primary', 'var(--color-pink-400)');
        console.log('üåô Huntflow: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞');
    } else {
        root.style.setProperty('--color-background', '#ffffff');
        root.style.setProperty('--color-surface', '#ffffff');
        root.style.setProperty('--color-text', '#13343b');
        root.style.setProperty('--color-primary', 'var(--color-lime-500)');
        console.log('‚òÄÔ∏è Huntflow: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–µ—Ç–ª—ã–µ —Ü–≤–µ—Ç–∞');
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
    localStorage.setItem('theme', newTheme);
    console.log('üíæ Huntflow: –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage:', localStorage.getItem('theme'));
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
    updateThemeIcon(newTheme);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    showThemeNotification(newTheme);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ —Ç–µ–º—ã
function updateThemeIcon(theme) {
    const themeIcon = document.getElementById('themeIcon');
    if (themeIcon) {
        if (theme === 'dark') {
            themeIcon.className = 'fas fa-moon';
        } else {
            themeIcon.className = 'fas fa-sun';
        }
        console.log('üé® Huntflow: –ò–∫–æ–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è —Ç–µ–º—ã:', theme);
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–º–µ–Ω–µ —Ç–µ–º—ã
function showThemeNotification(theme) {
    const themeName = theme === 'dark' ? '–¢—ë–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è';
    
    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    const notification = document.createElement('div');
    notification.className = 'alert alert-info alert-dismissible fade show position-fixed';
    notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 200px;';
    
    notification.innerHTML = `
        <i class="fas fa-${theme === 'dark' ? 'moon' : 'sun'} me-2"></i>
        –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ ${themeName} —Ç–µ–º—É
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    document.body.appendChild(notification);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(function() {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 3000);
}

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–∞–ø—Å–∏—Ä—É—é—â–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–ª–ª–∞–ø—Å–∏—Ä—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
    const collapsibleToggles = document.querySelectorAll('.collapsible-toggle');
    const collapsibleColumns = document.querySelectorAll('.collapsible-column');
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ localStorage
    const savedColumns = JSON.parse(localStorage.getItem('benchmarkColumns') || '{}');
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    collapsibleToggles.forEach(toggle => {
        const columnName = toggle.dataset.column;
        const isVisible = savedColumns[columnName] || false;
        
        if (isVisible) {
            toggle.classList.add('active');
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã
            const columns = document.querySelectorAll(`[data-column="${columnName}"]`);
            columns.forEach(col => col.classList.add('show'));
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
    collapsibleToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
            const columnName = this.dataset.column;
            const isActive = this.classList.contains('active');
            
            if (isActive) {
                // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã
                this.classList.remove('active');
                const columns = document.querySelectorAll(`[data-column="${columnName}"]`);
                columns.forEach(col => col.classList.remove('show'));
                savedColumns[columnName] = false;
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã
                this.classList.add('active');
                const columns = document.querySelectorAll(`[data-column="${columnName}"]`);
                columns.forEach(col => col.classList.add('show'));
                savedColumns[columnName] = true;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ localStorage
            localStorage.setItem('benchmarkColumns', JSON.stringify(savedColumns));
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
    const deleteButtons = document.querySelectorAll('.delete-benchmark-btn');
    deleteButtons.forEach(button => {
        button.addEventListener('click', function() {
            const benchmarkId = this.dataset.benchmarkId;
            deleteBenchmark(benchmarkId);
        });
    });
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ Huntflow: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã...');
    
    // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é
    const savedTheme = localStorage.getItem('theme');
    const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    const theme = savedTheme || systemTheme;
    
    console.log('üíæ Huntflow: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Ç–µ–º–∞:', savedTheme);
    console.log('üñ•Ô∏è Huntflow: –°–∏—Å—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞:', systemTheme);
    console.log('üéØ Huntflow: –í—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞:', theme);
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
    document.documentElement.setAttribute('data-theme', theme);
    console.log('‚úÖ Huntflow: –ê—Ç—Ä–∏–±—É—Ç data-theme —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', document.documentElement.getAttribute('data-theme'));
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    const root = document.documentElement;
    if (theme === 'dark') {
        root.style.setProperty('--color-background', '#0d1117');
        root.style.setProperty('--color-surface', '#161b22');
        root.style.setProperty('--color-text', 'var(--color-luna-400)');
        root.style.setProperty('--color-primary', 'var(--color-pink-400)');
        console.log('üåô Huntflow: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ');
    } else {
        root.style.setProperty('--color-background', '#ffffff');
        root.style.setProperty('--color-surface', '#ffffff');
        root.style.setProperty('--color-text', '#13343b');
        root.style.setProperty('--color-primary', 'var(--color-lime-500)');
        console.log('‚òÄÔ∏è Huntflow: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–µ—Ç–ª—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ');
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
    updateThemeIcon(theme);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
    const themeToggle = document.getElementById('themeToggle');
    console.log('üîò Huntflow: –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –Ω–∞–π–¥–µ–Ω–∞:', themeToggle);
    if (themeToggle) {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
        themeToggle.removeEventListener('click', toggleTheme);
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
        themeToggle.addEventListener('click', toggleTheme);
        console.log('‚úÖ Huntflow: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω');
    } else {
        console.error('‚ùå Huntflow: –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
    }
    
    // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
            const newTheme = e.matches ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            updateThemeIcon(newTheme);
        }
    });
    
    console.log('‚úÖ Huntflow: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
    
    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    window.testThemeToggle = function() {
        console.log('üß™ Huntflow: –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã...');
        toggleTheme();
    };
});
</script>
{% endblock %}

