{
  "openapi": "3.0.3",
  "info": {
    "title": "Vacancies API",
    "description": "API для управления вакансиями в системе HR Helper",
    "version": "1.0.0",
    "contact": {
      "name": "HR Helper Support",
      "email": "support@hrhelper.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8000/api",
      "description": "Development server"
    }
  ],
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "paths": {
    "/vacancies/": {
      "get": {
        "summary": "Список вакансий",
        "description": "Получение списка вакансий с фильтрацией и пагинацией",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Номер страницы",
            "schema": {"type": "integer", "default": 1}
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Количество элементов на странице",
            "schema": {"type": "integer", "default": 20}
          },
          {
            "name": "search",
            "in": "query",
            "description": "Поиск по названию, ID, заголовкам",
            "schema": {"type": "string"}
          },
          {
            "name": "recruiter",
            "in": "query",
            "description": "Фильтр по рекрутеру",
            "schema": {"type": "integer"}
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Фильтр по статусу активности",
            "schema": {"type": "boolean"}
          },
          {
            "name": "available_grades",
            "in": "query",
            "description": "Фильтр по грейду",
            "schema": {"type": "integer"}
          },
          {
            "name": "ordering",
            "in": "query",
            "description": "Сортировка",
            "schema": {"type": "string", "enum": ["name", "-name", "created_at", "-created_at"]}
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {"type": "integer"},
                    "next": {"type": "string", "nullable": true},
                    "previous": {"type": "string", "nullable": true},
                    "results": {
                      "type": "array",
                      "items": {"$ref": "#/components/schemas/Vacancy"}
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Создание вакансии",
        "description": "Создание новой вакансии",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {"$ref": "#/components/schemas/VacancyCreate"}
            }
          }
        },
        "responses": {
          "201": {
            "description": "Вакансия создана",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          },
          "400": {
            "description": "Ошибка валидации",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Error"}
              }
            }
          }
        }
      }
    },
    "/vacancies/{id}/": {
      "get": {
        "summary": "Получение вакансии",
        "description": "Получение конкретной вакансии по ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          },
          "404": {
            "description": "Вакансия не найдена",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Error"}
              }
            }
          }
        }
      },
      "put": {
        "summary": "Обновление вакансии",
        "description": "Полное обновление вакансии",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {"$ref": "#/components/schemas/VacancyCreate"}
            }
          }
        },
        "responses": {
          "200": {
            "description": "Вакансия обновлена",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Частичное обновление вакансии",
        "description": "Частичное обновление вакансии",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {"$ref": "#/components/schemas/VacancyUpdate"}
            }
          }
        },
        "responses": {
          "200": {
            "description": "Вакансия обновлена",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удаление вакансии",
        "description": "Удаление вакансии",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "responses": {
          "204": {
            "description": "Вакансия удалена"
          }
        }
      }
    },
    "/vacancies/{id}/toggle-active/": {
      "post": {
        "summary": "Переключение активности",
        "description": "Переключение статуса активности вакансии",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "responses": {
          "200": {
            "description": "Статус переключен",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          }
        }
      }
    },
    "/vacancies/{id}/assign-grades/": {
      "post": {
        "summary": "Назначение грейдов",
        "description": "Назначение грейдов вакансии",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "grade_ids": {
                    "type": "array",
                    "items": {"type": "integer"}
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Грейды назначены",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/Vacancy"}
              }
            }
          }
        }
      }
    },
    "/vacancies/my-vacancies/": {
      "get": {
        "summary": "Мои вакансии",
        "description": "Получение вакансий текущего пользователя",
        "responses": {
          "200": {
            "description": "Список вакансий пользователя",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {"$ref": "#/components/schemas/VacancyList"}
                }
              }
            }
          }
        }
      }
    },
    "/vacancies/stats/": {
      "get": {
        "summary": "Статистика",
        "description": "Получение статистики по вакансиям",
        "responses": {
          "200": {
            "description": "Статистика",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/VacancyStats"}
              }
            }
          }
        }
      }
    },
    "/vacancies/search/": {
      "get": {
        "summary": "Поиск вакансий",
        "description": "Расширенный поиск вакансий",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "description": "Поисковый запрос",
            "schema": {"type": "string"}
          },
          {
            "name": "grade_id",
            "in": "query",
            "description": "Фильтр по грейду",
            "schema": {"type": "integer"}
          },
          {
            "name": "recruiter_id",
            "in": "query",
            "description": "Фильтр по рекрутеру",
            "schema": {"type": "integer"}
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Фильтр по активности",
            "schema": {"type": "boolean"}
          }
        ],
        "responses": {
          "200": {
            "description": "Результаты поиска",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {"type": "integer"},
                    "next": {"type": "string", "nullable": true},
                    "previous": {"type": "string", "nullable": true},
                    "results": {
                      "type": "array",
                      "items": {"$ref": "#/components/schemas/VacancyList"}
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Vacancy": {
        "type": "object",
        "properties": {
          "id": {"type": "integer", "readOnly": true},
          "name": {"type": "string", "maxLength": 200},
          "external_id": {"type": "string", "maxLength": 100},
          "recruiter": {"type": "integer"},
          "recruiter_name": {"type": "string", "readOnly": true},
          "recruiter_username": {"type": "string", "readOnly": true},
          "invite_title": {"type": "string", "maxLength": 200},
          "invite_text": {"type": "string"},
          "scorecard_title": {"type": "string", "maxLength": 200},
          "scorecard_link": {"type": "string", "format": "uri"},
          "questions_belarus": {"type": "string"},
          "questions_poland": {"type": "string"},
          "vacancy_link_belarus": {"type": "string", "format": "uri"},
          "vacancy_link_poland": {"type": "string", "format": "uri"},
          "candidate_update_prompt": {"type": "string"},
          "invite_prompt": {"type": "string"},
          "screening_duration": {"type": "integer", "minimum": 1, "maximum": 480, "default": 45},
          "available_grades": {"type": "array", "items": {"type": "integer"}},
          "available_grades_names": {"type": "array", "items": {"type": "string"}, "readOnly": true},
          "interviewers": {"type": "array", "items": {"type": "integer"}},
          "is_active": {"type": "boolean", "default": true},
          "created_at": {"type": "string", "format": "date-time", "readOnly": true},
          "updated_at": {"type": "string", "format": "date-time", "readOnly": true}
        },
        "required": ["name", "external_id", "recruiter", "invite_title", "invite_text", "scorecard_title"]
      },
      "VacancyCreate": {
        "type": "object",
        "properties": {
          "name": {"type": "string", "maxLength": 200},
          "external_id": {"type": "string", "maxLength": 100},
          "recruiter": {"type": "integer"},
          "invite_title": {"type": "string", "maxLength": 200},
          "invite_text": {"type": "string"},
          "scorecard_title": {"type": "string", "maxLength": 200},
          "scorecard_link": {"type": "string", "format": "uri"},
          "questions_belarus": {"type": "string"},
          "questions_poland": {"type": "string"},
          "vacancy_link_belarus": {"type": "string", "format": "uri"},
          "vacancy_link_poland": {"type": "string", "format": "uri"},
          "candidate_update_prompt": {"type": "string"},
          "invite_prompt": {"type": "string"},
          "screening_duration": {"type": "integer", "minimum": 1, "maximum": 480, "default": 45},
          "available_grades": {"type": "array", "items": {"type": "integer"}},
          "interviewers": {"type": "array", "items": {"type": "integer"}},
          "is_active": {"type": "boolean", "default": true}
        },
        "required": ["name", "external_id", "recruiter", "invite_title", "invite_text", "scorecard_title"]
      },
      "VacancyUpdate": {
        "type": "object",
        "properties": {
          "name": {"type": "string", "maxLength": 200},
          "external_id": {"type": "string", "maxLength": 100},
          "recruiter": {"type": "integer"},
          "invite_title": {"type": "string", "maxLength": 200},
          "invite_text": {"type": "string"},
          "scorecard_title": {"type": "string", "maxLength": 200},
          "scorecard_link": {"type": "string", "format": "uri"},
          "questions_belarus": {"type": "string"},
          "questions_poland": {"type": "string"},
          "vacancy_link_belarus": {"type": "string", "format": "uri"},
          "vacancy_link_poland": {"type": "string", "format": "uri"},
          "candidate_update_prompt": {"type": "string"},
          "invite_prompt": {"type": "string"},
          "screening_duration": {"type": "integer", "minimum": 1, "maximum": 480},
          "available_grades": {"type": "array", "items": {"type": "integer"}},
          "interviewers": {"type": "array", "items": {"type": "integer"}},
          "is_active": {"type": "boolean"}
        }
      },
      "VacancyList": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "name": {"type": "string"},
          "external_id": {"type": "string"},
          "recruiter_name": {"type": "string"},
          "available_grades_count": {"type": "integer"},
          "is_active": {"type": "boolean"},
          "created_at": {"type": "string", "format": "date-time"}
        }
      },
      "VacancyStats": {
        "type": "object",
        "properties": {
          "total_vacancies": {"type": "integer"},
          "active_vacancies": {"type": "integer"},
          "inactive_vacancies": {"type": "integer"},
          "vacancies_by_recruiter": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "total": {"type": "integer"},
                "active": {"type": "integer"}
              }
            }
          },
          "vacancies_by_grade": {
            "type": "object",
            "additionalProperties": {"type": "integer"}
          },
          "recent_vacancies": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/VacancyList"}
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "error": {"type": "string"},
          "details": {"type": "string"},
          "code": {"type": "string"}
        }
      }
    }
  }
}
