# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Vacancies

## üìã **–û–±–∑–æ—Ä**

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –æ—à–∏–±–æ–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ `@vacancies/` –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ–¥–∞. –ë—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª–µ–º –º–æ–¥–µ–ª–∏ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `prefetch_related`.

## üêõ **–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏**

### 1. **–û—à–∏–±–∫–∞: Cannot filter a query once a slice has been taken**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —É–∂–µ –Ω–∞—Ä–µ–∑–∞–Ω–Ω—ã–π queryset –≤ `ResponseHandler.pagination_context()`
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `logic/response_handlers.py:159`
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `original_queryset` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ queryset –¥–æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

### 2. **–û—à–∏–±–∫–∞: Cannot find 'available_grades' on Vacancy object**
- **–ü—Ä–∏—á–∏–Ω–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—è `available_grades` –≤ –º–æ–¥–µ–ª–∏ `Vacancy`
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ, —Å—Å—ã–ª–∞—é—â–∏–µ—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `available_grades` –≤ –º–æ–¥–µ–ª—å `Vacancy`

### 3. **–û—à–∏–±–∫–∞: 'available_grades' is an invalid parameter to prefetch_related()**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related('available_grades')` –¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è –≤ –º–æ–¥–µ–ª—å
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `logic/vacancy_handlers.py` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Ç–æ–¥–∞—Ö
- **–†–µ—à–µ–Ω–∏–µ**: –í—Ä–µ–º–µ–Ω–Ω–æ —É–±—Ä–∞–Ω–æ –∏–∑ `prefetch_related`, –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è

## üîß **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ResponseHandler.pagination_context()**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –°—Ç–∞—Ä—ã–π –∫–æ–¥ - –æ—à–∏–±–∫–∞
context['active_count'] = queryset.filter(is_active=True).count()
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ù–æ–≤—ã–π –∫–æ–¥ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
@staticmethod
def pagination_context(page_obj, search_form=None, original_queryset=None, **filters):
    # ...
    # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ queryset
    if original_queryset is not None and hasattr(original_queryset, 'model'):
        context['active_count'] = original_queryset.filter(is_active=True).count()
        context['inactive_count'] = original_queryset.filter(is_active=False).count()
```

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤ views.py:**
```python
# vacancy_list
context = ResponseHandler.pagination_context(
    page_obj,
    search_form,
    original_queryset=vacancies,  # –ü–µ—Ä–µ–¥–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π queryset
    # ...
)

# salary_ranges_list  
context = ResponseHandler.pagination_context(
    page_obj,
    search_form,
    original_queryset=salary_ranges,  # –ü–µ—Ä–µ–¥–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π queryset
    # ...
)
```

### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è available_grades –≤ –º–æ–¥–µ–ª—å Vacancy**

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ models.py:**
```python
class Vacancy(models.Model):
    # ...
    available_grades = models.ManyToManyField(
        Grade,
        related_name='available_vacancies',
        verbose_name='–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä–µ–π–¥—ã',
        help_text='–ì—Ä–µ–π–¥—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –¥–∞–Ω–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏',
        blank=True
    )
    # ...
```

**–°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è:**
```bash
python manage.py makemigrations vacancies
python manage.py migrate
```

### 3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ VacancyForm**

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ forms.py:**
```python
class VacancyForm(forms.ModelForm):
    class Meta:
        fields = [
            # ...
            'available_grades',  # –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ
            # ...
        ]
        widgets = {
            # ...
            'available_grades': forms.CheckboxSelectMultiple(attrs={
                'class': 'form-check-input'
            }),
            # ...
        }
        labels = {
            # ...
            'available_grades': '–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä–µ–π–¥—ã',
            # ...
        }
        help_texts = {
            # ...
            'available_grades': '–ì—Ä–µ–π–¥—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –¥–∞–Ω–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏',
            # ...
        }
    
    def __init__(self, *args, **kwargs):
        # ...
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≥—Ä–µ–π–¥–∞–º–∏
        from apps.finance.models import Grade
        self.fields['available_grades'].queryset = Grade.objects.filter(is_active=True)
        # ...
```

### 4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ prefetch_related –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö**

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ vacancy_handlers.py:**
```python
# –í search_logic
queryset = Vacancy.objects.select_related('recruiter').prefetch_related(
    'available_grades', 'interviewers'  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ available_grades
).all()

# –í calculate_stats
recent_vacancies = base_queryset.select_related('recruiter').prefetch_related(
    'available_grades', 'interviewers'  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ available_grades
).order_by('-created_at')[:5]

# –í get_my_vacancies_logic
return Vacancy.objects.select_related('recruiter').prefetch_related(
    'available_grades', 'interviewers'  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ available_grades
).filter(recruiter=user).order_by('-created_at')
```

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—à–∏–±–æ–∫**: 3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤**: 4 (models.py, forms.py, response_handlers.py, vacancy_handlers.py)
- **–°–æ–∑–¥–∞–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–π**: 1 (0010_vacancy_available_grades.py)
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ–π**: 1 (available_grades –≤ –º–æ–¥–µ–ª—å Vacancy)

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `available_grades` —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **–£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `prefetch_related`
4. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –≥—Ä–µ–π–¥—ã –∫ –≤–∞–∫–∞–Ω—Å–∏—è–º

## ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã**

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
python manage.py check
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: `System check identified no issues (0 silenced).`

**–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**: ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—à–∏–±–æ–∫**

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ –º–æ–¥–µ–ª–∏**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª–µ `available_grades` –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ, –Ω–æ –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–≥–æ
- **–£—Ä–æ–∫**: –ü—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª—è –º–æ–¥–µ–ª–µ–π

### 2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —É–∂–µ –Ω–∞—Ä–µ–∑–∞–Ω–Ω—ã–π queryset –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- **–£—Ä–æ–∫**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω—É–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –¥–æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, –∞ –Ω–µ –ø–æ—Å–ª–µ

### 3. **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–¥–æ–º –∏ –º–æ–¥–µ–ª—å—é**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ö–æ–¥ –æ–∂–∏–¥–∞–ª –ø–æ–ª–µ, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –±—ã–ª–æ –≤ –º–æ–¥–µ–ª–∏
- **–£—Ä–æ–∫**: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–¥–æ–º –∏ —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ**

1. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ–ª–µ–π** - –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
2. **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã** - –ø–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è** - –≤–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–æ–¥–µ–ª–∏
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å type hints** - –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ –≤ IDE

## üìù **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ `@vacancies/` —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã. –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ `available_grades`, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å—à–∏—Ä—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –∫–æ–¥ –æ—Å—Ç–∞–ª—Å—è –ø–æ–Ω—è—Ç–Ω—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º
