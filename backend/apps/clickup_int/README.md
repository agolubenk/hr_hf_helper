# ClickUp интеграция

Приложение для интеграции с ClickUp API, позволяющее синхронизировать и отображать задачи из ClickUp.

## Возможности

- **Настройка интеграции**: Подключение к ClickUp через API токен
- **Синхронизация задач**: Автоматическая и ручная синхронизация задач
- **Просмотр задач**: Список задач с фильтрацией и поиском
- **Детальная информация**: Полная информация о задаче включая вложения
- **Логи синхронизации**: История всех операций синхронизации

## Структура приложения

### Модели

- **ClickUpSettings**: Настройки интеграции для пользователя
- **ClickUpTask**: Кэшированные задачи из ClickUp
- **ClickUpSyncLog**: Логи синхронизации

### Сервисы

- **ClickUpService**: Основной сервис для работы с ClickUp API
- **ClickUpCacheService**: Сервис для работы с кэшем задач

### Views

- **dashboard**: Главная страница с обзором интеграции
- **settings_view**: Страница настроек интеграции
- **tasks_list**: Список задач с фильтрацией
- **task_detail**: Детальная информация о задаче
- **sync_logs**: Логи синхронизации

## Настройка

### 1. Настройка API токена

1. Войдите в ClickUp
2. Перейдите в настройки профиля
3. Найдите раздел "Apps"
4. Создайте новый API токен
5. Скопируйте токен (начинается с "pk_")
6. Перейдите в профиль HR Helper → API ключи
7. Введите токен в поле "ClickUp API ключ"

### 2. Настройка пути к задачам

Для настройки интеграции необходимо указать путь к списку задач:

1. **Команда (Team ID)**: ID команды в ClickUp
2. **Пространство (Space ID)**: ID пространства в команде
3. **Папка (Folder ID)**: ID папки в пространстве (опционально)
4. **Список (List ID)**: ID списка задач

### 3. Поиск ID элементов

ID элементов можно найти в URL при работе с ClickUp:

- **Команда**: URL содержит `/team/`
- **Пространство**: URL содержит `/space/`
- **Папка**: URL содержит `/folder/`
- **Список**: URL содержит `/list/`

## Использование

### Синхронизация задач

1. Перейдите в настройки и укажите путь к задачам
2. Нажмите "Синхронизировать" на дашборде или в списке задач
3. Система загрузит задачи из указанного списка

### Просмотр задач

- **Список задач**: Фильтрация по статусу, приоритету, поиск по названию
- **Детальная информация**: Полная информация о задаче, вложения, участники
- **Ссылки**: Прямые ссылки на задачи в ClickUp

### Автоматическая синхронизация

В настройках можно включить автоматическую синхронизацию с указанием интервала (от 1 до 1440 минут).

## API Endpoints

- `GET /clickup/` - Дашборд
- `GET /clickup/settings/` - Настройки
- `GET /clickup/tasks/` - Список задач
- `GET /clickup/task/<task_id>/` - Детальная информация о задаче
- `GET /clickup/sync-logs/` - Логи синхронизации

### API для тестирования

- `POST /clickup/api/test-connection/` - Тестирование подключения
- `GET /clickup/api/path-options/` - Получение вариантов пути
- `GET /clickup/api/spaces/` - Получение пространств команды
- `GET /clickup/api/folders/` - Получение папок пространства
- `GET /clickup/api/lists/` - Получение списков задач
- `POST /clickup/api/sync-tasks/` - Синхронизация задач
- `POST /clickup/api/clear-cache/` - Очистка кэша

## Безопасность

- API токены хранятся в зашифрованном виде
- Доступ к задачам только для авторизованных пользователей
- Каждый пользователь видит только свои задачи

## Ограничения

- ClickUp API имеет лимиты на количество запросов
- Синхронизация может занять время при большом количестве задач
- Вложения загружаются только при детальном просмотре задачи

## Логирование

Все операции синхронизации логируются в модель `ClickUpSyncLog` с указанием:
- Статуса операции (успешно/ошибка/частично)
- Количества обработанных задач
- Времени выполнения
- Сообщений об ошибках

## Разработка

### Добавление новых функций

1. Создайте новые методы в `ClickUpService`
2. Добавьте соответствующие views
3. Создайте шаблоны
4. Обновите URLs

### Тестирование

Для тестирования используйте тестовый API токен ClickUp и тестовые данные.

## Поддержка

При возникновении проблем проверьте:
1. Правильность API токена
2. Корректность ID элементов пути
3. Права доступа к списку задач
4. Логи синхронизации на предмет ошибок
