# –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Accounts

## üéØ –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `accounts`, –≤–∫–ª—é—á–∞—è —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, JSON API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã](#—Ä–∞–±–æ—á–∏–µ-–ø—Ä–æ—Ü–µ—Å—Å—ã)
2. [JSON API —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã](#json-api-—Ä–∞–±–æ—á–∏–µ-–ø—Ä–æ—Ü–µ—Å—Å—ã)
3. [–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏](#–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è-—Å-–¥—Ä—É–≥–∏–º–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-—Ä–µ—à–µ–Ω–∏—è)
5. [–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π](#—Å–µ—Ä–≤–∏—Å–Ω—ã–π-—Å–ª–æ–π)
6. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
7. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
8. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
9. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
10. [Troubleshooting](#troubleshooting)

---

## üîÑ –†–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 1.1 –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[–§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏]
    B --> C[–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö]
    C --> D{–î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã?}
    D -->|–î–∞| E[–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    D -->|–ù–µ—Ç| F[–ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫–∏]
    E --> G[–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏"]
    G --> H[–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è]
    H --> I[–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è]
    F --> B
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (email —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å, –ø–∞—Ä–æ–ª—å)
3. –°–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ `UserService.create_user_with_observer_role()`
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ä–æ–ª—å "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏"
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

#### 1.2 Google OAuth —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[–ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"]
    B --> C[–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Google OAuth]
    C --> D[–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Google]
    D --> E[Callback —Å –∫–æ–¥–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏]
    E --> F[–û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω]
    F --> G[–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    G --> H{–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?}
    H -->|–î–∞| I[–°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤]
    H -->|–ù–µ—Ç| J[–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    I --> K[–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è]
    J --> L[–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏"]
    L --> K
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
2. –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç state parameter –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Google OAuth —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ Google
5. Google –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
6. –°–∏—Å—Ç–µ–º–∞ –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç –∫–æ–¥ –Ω–∞ access token
7. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç Google
8. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email
9. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –∏–ª–∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
10. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç —Ä–æ–ª—å "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏"
11. –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏

#### 2.1 –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π
```mermaid
graph TD
    A[–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä] --> B[–í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    B --> C[–í—ã–±–æ—Ä —Ä–æ–ª–∏]
    C --> D[RoleService.assign_role_to_user()]
    D --> E{–†–æ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?}
    E -->|–î–∞| F[–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É]
    E -->|–ù–µ—Ç| G[–û—à–∏–±–∫–∞: —Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞]
    F --> H[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤ —Ä–æ–ª–µ–π]
    H --> I[–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ]
    G --> J[–ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É]
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –í—ã–±–∏—Ä–∞–µ—Ç —Ä–æ–ª—å –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã, –†–µ–∫—Ä—É—Ç–µ—Ä—ã, –ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã, –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏)
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `RoleService.assign_role_to_user()`
4. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–∏
5. –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≥—Ä—É–ø–ø—É
6. –û–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–ª–∞–≥–∏ —Ä–æ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `is_observer_active`)
7. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏

#### 2.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```mermaid
graph TD
    A[–ó–∞–ø—Ä–æ—Å –∫ API] --> B[–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏]
    B --> C{–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω?}
    C -->|–ù–µ—Ç| D[401 Unauthorized]
    C -->|–î–∞| E[–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞]
    E --> F{–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤?}
    F -->|–ù–µ—Ç| G[403 Forbidden]
    F -->|–î–∞| H[–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏]
    H --> I[–í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞]
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ API
2. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (—Å–µ—Å—Å–∏—è, —Ç–æ–∫–µ–Ω)
3. –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π
5. –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 403
6. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞–º–∏

#### 3.1 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π
```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[–§–æ—Ä–º–∞ API –∫–ª—é—á–µ–π]
    B --> C[–í–≤–æ–¥ –∫–ª—é—á–µ–π]
    C --> D[–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞]
    D --> E{–ö–ª—é—á–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã?}
    E -->|–î–∞| F[UserService.update_user_api_keys()]
    E -->|–ù–µ—Ç| G[–ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫–∏]
    F --> H[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î]
    H --> I[–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ]
    G --> B
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É API –∫–ª—é—á–µ–π
2. –°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `UserService.update_user_api_keys()`
4. –ö–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ

#### 3.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π
```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[–ö–Ω–æ–ø–∫–∞ "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å"]
    B --> C[–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞]
    C --> D[–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞]
    D --> E{–ö–ª—é—á –≤–∞–ª–∏–¥–µ–Ω?}
    E -->|–î–∞| F[–ü–æ–∫–∞–∑–∞—Ç—å "–ö–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç"]
    E -->|–ù–µ—Ç| G[–ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É]
    F --> H[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞]
    G --> I[–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å]
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è API –∫–ª—é—á–∞
2. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API
3. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç API
4. –ï—Å–ª–∏ –∫–ª—é—á –≤–∞–ª–∏–¥–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—Ö
5. –ï—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

#### 4.1 –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[–ö–Ω–æ–ø–∫–∞ "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"]
    B --> C[–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π]
    C --> D[–ó–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API]
    D --> E[–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞]
    E --> F[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö]
    F --> G[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞]
    G --> H[–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"
2. –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç API –∫–ª—é—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –î–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API (Huntflow, ClickUp, Notion)
4. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
6. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
7. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

---

## üîå JSON API —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JSON API

#### 1.1 –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```mermaid
sequenceDiagram
    participant C as Client
    participant V as View
    participant S as Service
    participant D as Database
    
    C->>V: POST /accounts/api/login/
    V->>S: login_api_handler()
    S->>D: authenticate(username, password)
    D-->>S: User object or None
    alt Authentication Success
        S->>V: Success response
        V->>C: JSON success + user data
    else Authentication Failed
        S->>V: Error response
        V->>C: JSON error message
    end
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. `unified_api_view` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `login_api_handler()`
4. –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è JSON –æ—Ç–≤–µ—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

#### 1.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π
```mermaid
sequenceDiagram
    participant C as Client
    participant V as View
    participant S as Service
    participant E as External API
    
    C->>V: POST /accounts/api/test-gemini/
    V->>S: test_gemini_api_handler()
    S->>E: Test API request
    E-->>S: API response
    S->>V: Processed result
    V->>C: JSON response
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç API –∫–ª—é—á –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. –°–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API
3. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç API
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. REST API —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

#### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ REST API
```mermaid
sequenceDiagram
    participant C as Client
    participant V as UserViewSet
    participant S as UserService
    participant D as Database
    
    C->>V: POST /api/users/
    V->>S: create_user_with_observer_role()
    S->>D: Create User object
    D-->>S: User created
    S->>V: User data
    V->>C: JSON response (201 Created)
```

#### 2.2 –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ REST API
```mermaid
sequenceDiagram
    participant C as Client
    participant V as UserViewSet
    participant S as RoleService
    participant D as Database
    
    C->>V: POST /api/users/1/assign-groups/
    V->>S: assign_role_to_user()
    S->>D: Add user to group
    D-->>S: Success
    S->>V: Success response
    V->>C: JSON confirmation
```

### 3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 3.1 –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
```mermaid
graph TD
    A[Request] --> B[unified_template_view]
    B --> C{handler_func provided?}
    C -->|Yes| D[Call handler_func]
    C -->|No| E[Use default context]
    D --> F[Prepare context]
    E --> F
    F --> G[Render template]
    G --> H[Return HTML response]
```

#### 3.2 –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ API
```mermaid
graph TD
    A[Request] --> B[unified_api_view]
    B --> C{Method = POST?}
    C -->|No| D[405 Method Not Allowed]
    C -->|Yes| E[Parse JSON]
    E --> F{Valid JSON?}
    F -->|No| G[400 Bad Request]
    F -->|Yes| H[Call handler_func]
    H --> I[Process data]
    I --> J[Return JSON response]
```

---

## üîó –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏

### 1. Google OAuth (apps.google_oauth)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª–∏:
```python
# OneToOne —Å–≤—è–∑—å
class GoogleOAuthAccount(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    access_token = models.TextField()
    refresh_token = models.TextField()
    token_expires_at = models.DateTimeField()
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** OAuth flow —á–µ—Ä–µ–∑ Google
- **–î–∞–Ω–Ω—ã–µ:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å, Drive, Sheets
- **API –∫–ª—é—á–∏:** –•—Ä–∞–Ω—è—Ç—Å—è –≤ `User.gemini_api_key`
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Google OAuth
2. –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç access token
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω –≤ `GoogleOAuthAccount`
4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Google API
5. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∫–∞–ª–µ–Ω–¥–∞—Ä—å, —Ñ–∞–π–ª—ã)

### 2. Huntflow (apps.huntflow)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ API –∫–ª—é—á–∏:
```python
# API –∫–ª—é—á–∏ –≤ –º–æ–¥–µ–ª–∏ User
huntflow_prod_api_key = models.CharField(max_length=256, blank=True)
huntflow_sandbox_api_key = models.CharField(max_length=256, blank=True)
huntflow_prod_url = models.URLField(blank=True)
huntflow_sandbox_url = models.URLField(blank=True)
active_system = models.CharField(choices=SystemChoice.choices, default=SystemChoice.SANDBOX)
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–î–∞–Ω–Ω—ã–µ:** –ö–∞–Ω–¥–∏–¥–∞—Ç—ã, –≤–∞–∫–∞–Ω—Å–∏–∏, –∏–Ω—Ç–µ—Ä–≤—å—é
- **API:** REST API Huntflow
- **–°–∏—Å—Ç–µ–º—ã:** Prod –∏ Sandbox
- **–†–æ–ª–∏:** –†–µ–∫—Ä—É—Ç–µ—Ä—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç API –∫–ª—é—á–∏ Huntflow
2. –í—ã–±–∏—Ä–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É (prod/sandbox)
3. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª—é—á–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Huntflow API
4. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏
5. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∏–Ω—Ç–µ—Ä–≤—å—é

### 3. Gemini AI (apps.gemini)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ API –∫–ª—é—á:
```python
# API –∫–ª—é—á –≤ –º–æ–¥–µ–ª–∏ User
gemini_api_key = models.CharField(max_length=256, blank=True)
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–§—É–Ω–∫—Ü–∏–∏:** AI –∞–Ω–∞–ª–∏–∑, —á–∞—Ç, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **API:** Google Gemini API
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π –≤–∞–∫–∞–Ω—Å–∏–π

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Gemini API –∫–ª—é—á
2. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª—é—á –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Gemini API
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–π
5. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç AI-–ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è —Ä–µ–∫—Ä—É—Ç–µ—Ä–æ–≤

### 4. Telegram (apps.telegram)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª–∏:
```python
# OneToOne —Å–≤—è–∑—å
class TelegramUser(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    telegram_id = models.BigIntegerField(unique=True)
    username = models.CharField(max_length=64, blank=True)
    is_authorized = models.BooleanField(default=False)
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–§—É–Ω–∫—Ü–∏–∏:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –±–æ—Ç-–∫–æ–º–∞–Ω–¥—ã
- **–ü–æ–ª–µ:** `User.telegram_username`
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ß–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–≤—è–∑—ã–≤–∞–µ—Ç Telegram –∞–∫–∫–∞—É–Ω—Ç
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç Telegram ID
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö
4. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ—Ç-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
5. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∏–Ω—Ç–µ—Ä–≤—å—é

### 5. Notion (apps.notion_int)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ Integration Token:
```python
# Integration Token –≤ –º–æ–¥–µ–ª–∏ User
notion_integration_token = models.CharField(max_length=256, blank=True)
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–î–∞–Ω–Ω—ã–µ:** –°—Ç—Ä–∞–Ω–∏—Ü—ã, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **API:** Notion API
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Notion Integration Token
2. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Notion API
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö
5. –°–æ–∑–¥–∞–µ—Ç –æ—Ç—á–µ—Ç—ã –≤ Notion

### 6. ClickUp (apps.clickup_int)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ API –∫–ª—é—á:
```python
# API –∫–ª—é—á –≤ –º–æ–¥–µ–ª–∏ User
clickup_api_key = models.CharField(max_length=256, blank=True)
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–î–∞–Ω–Ω—ã–µ:** –ó–∞–¥–∞—á–∏, –ø—Ä–æ–µ–∫—Ç—ã, –∫–æ–º–∞–Ω–¥—ã
- **API:** ClickUp API
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ó–∞–¥–∞—á–∏ –∏ —Å—Ç–∞—Ç—É—Å—ã

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç ClickUp API –∫–ª—é—á
2. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª—é—á –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ ClickUp API
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á–∏ –∏ –ø—Ä–æ–µ–∫—Ç—ã
4. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á
5. –°–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–µ–∫—Ä—É—Ç–µ—Ä–æ–≤

### 7. Interviewers (apps.interviewers)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã –∏ –ø–æ–ª—è:
```python
# –ü–æ–ª–µ –≤ –º–æ–¥–µ–ª–∏ User
interviewer_calendar_url = models.URLField(blank=True)

# –°–≤—è–∑—å —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã
def is_interviewer(self) -> bool:
    return self.groups.filter(name="–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã").exists()
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–§—É–Ω–∫—Ü–∏–∏:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é, –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- **–†–æ–ª–∏:** –ì—Ä—É–ø–ø–∞ "–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã"
- **–î–∞–Ω–Ω—ã–µ:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å, –∏–Ω—Ç–µ—Ä–≤—å—é, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ä–æ–ª—å "–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã"
2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞
3. –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å
4. –ù–∞–∑–Ω–∞—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤—å—é –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∏–Ω—Ç–µ—Ä–≤—å—é

### 8. Vacancies (apps.vacancies)

#### –°–≤—è–∑—å —á–µ—Ä–µ–∑ –ø–æ–ª–µ recruiter:
```python
# –í –º–æ–¥–µ–ª–∏ Vacancy
class Vacancy(models.Model):
    recruiter = models.ForeignKey(User, on_delete=models.CASCADE)
    title = models.CharField(max_length=255)
    description = models.TextField()
    # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
```

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- **–§—É–Ω–∫—Ü–∏–∏:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏—è–º–∏, –∞–Ω–∞–ª–∏–∑
- **–†–æ–ª–∏:** –†–µ–∫—Ä—É—Ç–µ—Ä—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- **–î–∞–Ω–Ω—ã–µ:** –í–∞–∫–∞–Ω—Å–∏–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã

#### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –†–µ–∫—Ä—É—Ç–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –≤–∞–∫–∞–Ω—Å–∏—é
2. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Gemini
3. –ü–æ–¥–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
4. –ù–∞–∑–Ω–∞—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤—å—é —á–µ—Ä–µ–∑ Interviewers
5. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞–π–º–∞

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π (Service Layer)

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
- **Single Responsibility:** –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É –æ–±–ª–∞—Å—Ç—å
- **Dependency Injection:** –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Reusability:** –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
logic/
‚îú‚îÄ‚îÄ user_service.py      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ role_service.py      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
‚îú‚îÄ‚îÄ oauth_service.py     # Google OAuth
‚îú‚îÄ‚îÄ auth_adapters.py     # –ê–¥–∞–ø—Ç–µ—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ serializers.py       # API —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
‚îî‚îÄ‚îÄ signals.py          # Django —Å–∏–≥–Ω–∞–ª—ã
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- –õ–µ–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### 2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
- **DRY:** –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π —Å–µ–±—è
- **Flexibility:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTML –∏ JSON
- **Consistency:** –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```python
# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
def unified_template_view(request, template_name, handler_func=None, context=None):
    if context is None:
        context = {}
    
    if handler_func:
        try:
            handler_context = handler_func(request)
            if isinstance(handler_context, dict):
                context.update(handler_context)
        except Exception as e:
            context['error'] = f'–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: {str(e)}'
    
    return render(request, template_name, context)

# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è API
@csrf_exempt
def unified_api_view(request, handler_func):
    if request.method != 'POST':
        return HttpResponseNotAllowed(['POST'])
    
    try:
        data = json.loads(request.body.decode('utf-8'))
    except json.JSONDecodeError:
        return JsonResponse({'error': 'Invalid JSON'}, status=400)
    
    response_data = handler_func(data, request)
    return JsonResponse(response_data)
```

### 3. –ü–∞—Ç—Ç–µ—Ä–Ω Handler

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
- **Separation of Concerns:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- **Modularity:** –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **Testability:** –õ–µ–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```python
# API handlers
def login_api_handler(data, request):
    # –õ–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
    pass

def test_gemini_api_handler(data, request):
    # –õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Gemini API
    pass

# Template handlers
def profile_template_handler(request):
    # –õ–æ–≥–∏–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Ñ–∏–ª—è
    pass

def integrations_template_handler(request):
    # –õ–æ–≥–∏–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
    pass
```

### 4. –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
- **Role-Based Access Control:** –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π
- **Flexibility:** –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤
- **Scalability:** –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ä–æ–ª–µ–π

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```python
class RoleService:
    ROLE_NAMES = ["–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã", "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏", "–†–µ–∫—Ä—É—Ç–µ—Ä—ã", "–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã"]
    
    @staticmethod
    def assign_role_to_user(user, role_name):
        # –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        pass
    
    @staticmethod
    def validate_role_permissions():
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ —Ä–æ–ª–µ–π
        pass
```

---

## ‚öôÔ∏è –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π

### 1. UserService

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
```python
class UserService:
    @staticmethod
    def get_user_profile_data(user):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        return {
            'user': user,
            'integrations_status': UserService.get_integrations_status(user),
            'roles': [group.name for group in user.groups.all()],
            'permissions': user.get_all_permissions()
        }
    
    @staticmethod
    def update_user_api_keys(user, data):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        for field in ['gemini_api_key', 'clickup_api_key', 'notion_integration_token',
                     'huntflow_prod_api_key', 'huntflow_sandbox_api_key']:
            if field in data:
                setattr(user, field, data[field])
        user.save()
    
    @staticmethod
    def get_user_stats():
        """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        return {
            'total_users': User.objects.count(),
            'active_users': User.objects.filter(is_active=True).count(),
            'staff_users': User.objects.filter(is_staff=True).count(),
            'groups_stats': {
                group.name: group.user_set.count()
                for group in Group.objects.all()
            }
        }
```

### 2. RoleService

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
```python
class RoleService:
    ROLE_NAMES = ["–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã", "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏", "–†–µ–∫—Ä—É—Ç–µ—Ä—ã", "–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã"]
    
    @staticmethod
    def assign_role_to_user(user, role_name):
        """–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        try:
            group = Group.objects.get(name=role_name)
            user.groups.add(group)
            return True
        except Group.DoesNotExist:
            return False
    
    @staticmethod
    def create_roles_and_permissions():
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤"""
        for role_name in RoleService.ROLE_NAMES:
            group, created = Group.objects.get_or_create(name=role_name)
            if created:
                # –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
                if role_name in ["–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã", "–†–µ–∫—Ä—É—Ç–µ—Ä—ã"]:
                    # –í—Å–µ –ø—Ä–∞–≤–∞
                    permissions = Permission.objects.all()
                else:
                    # –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä
                    permissions = Permission.objects.filter(codename__startswith='view_')
                
                group.permissions.set(permissions)
```

### 3. GoogleOAuthService

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
```python
class GoogleOAuthService:
    @staticmethod
    def get_authorization_url(request):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Google OAuth"""
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è state parameter
        # –°–æ–∑–¥–∞–Ω–∏–µ URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        pass
    
    @staticmethod
    def handle_oauth_callback(request):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ callback –æ—Ç Google OAuth"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ state parameter
        # –û–±–º–µ–Ω –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        pass
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –ú–µ—Ç–æ–¥—ã:
- **Session Authentication:** Django —Å–µ—Å—Å–∏–∏
- **Google OAuth 2.0:** –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **JSON API Authentication:** API —Ç–æ–∫–µ–Ω—ã

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- CSRF –∑–∞—â–∏—Ç–∞ –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
- State parameter –¥–ª—è OAuth
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

### 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π:
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã:** –í—Å–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- **–†–µ–∫—Ä—É—Ç–µ—Ä—ã:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏
- **–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã:** –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é
- **–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏:** –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä

#### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ API
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–æ–ª—è–º
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ —Ä–æ–ª—è–º

### 3. –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

#### API –∫–ª—é—á–∏:
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

#### –ü–∞—Ä–æ–ª–∏:
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Django
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

#### N+1 –ø—Ä–æ–±–ª–µ–º—ã:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `select_related()` –∏ `prefetch_related()`
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –≥—Ä—É–ø–ø–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –ü—Ä–∏–º–µ—Ä—ã:
```python
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
users = User.objects.select_related('groups').prefetch_related('groups__permissions')

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
@cached_property
def user_stats(self):
    return UserService.get_user_stats()
```

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```python
from django.core.cache import cache

def get_user_stats():
    cache_key = 'user_stats'
    stats = cache.get(cache_key)
    if not stats:
        stats = UserService.get_user_stats()
        cache.set(cache_key, stats, 300)  # 5 –º–∏–Ω—É—Ç
    return stats
```

### 3. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

#### Celery –∑–∞–¥–∞—á–∏:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

#### –ü—Ä–∏–º–µ—Ä—ã:
```python
from celery import shared_task

@shared_task
def sync_huntflow_data(user_id):
    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Huntflow
    pass

@shared_task
def send_notification(user_id, message):
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    pass
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- **DEBUG:** –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **INFO:** –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ
- **WARNING:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **ERROR:** –û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Ä–∞–±–æ—Ç—É
- **CRITICAL:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

#### –ü—Ä–∏–º–µ—Ä—ã:
```python
import logging

logger = logging.getLogger(__name__)

def handle_oauth_callback(request):
    logger.info(f"Google OAuth callback: code={code[:20]}...")
    
    try:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ callback
        pass
    except Exception as e:
        logger.error(f"OAuth error: {str(e)}", exc_info=True)
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### –ú–µ—Ç—Ä–∏–∫–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å API
- –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

#### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- Django Debug Toolbar –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- Sentry –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫
- Prometheus –¥–ª—è –º–µ—Ç—Ä–∏–∫
- Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

### 3. –ê–ª–µ—Ä—Ç—ã

#### –£—Å–ª–æ–≤–∏—è:
- –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤

#### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- Slack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Python 3.9+
- Django 5.2.6+
- PostgreSQL 12+
- Redis 6+
- Celery 5+

#### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```python
# requirements.txt
Django>=5.2.6
django-allauth>=0.57.0
djangorestframework>=3.14.0
requests>=2.31.0
pytz>=2025.2
celery>=5.3.0
redis>=4.5.0
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Django:
```python
# settings.py
INSTALLED_APPS = [
    'apps.accounts',
    'allauth',
    'allauth.account',
    'allauth.socialaccount',
    'allauth.socialaccount.providers.google',
    'rest_framework',
]

AUTH_USER_MODEL = 'accounts.User'

# Google OAuth
SOCIALACCOUNT_PROVIDERS = {
    'google': {
        'SCOPE': ['profile', 'email'],
        'AUTH_PARAMS': {'access_type': 'online'}
    }
}

ACCOUNT_ADAPTER = 'apps.accounts.logic.auth_adapters.CustomAccountAdapter'
SOCIALACCOUNT_ADAPTER = 'apps.accounts.logic.auth_adapters.CustomSocialAccountAdapter'
```

### 3. –ú–∏–≥—Ä–∞—Ü–∏–∏

#### –ö–æ–º–∞–Ω–¥—ã:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
python manage.py makemigrations accounts

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
python manage.py migrate

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π
python manage.py seed_roles

# –°–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
python manage.py createsuperuser
```

### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

#### –°–∫—Ä–∏–ø—Ç—ã:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π
python manage.py seed_roles

# –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–æ–ª–µ–π
python manage.py seed_roles --validate

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–æ–ª–µ–π
python manage.py seed_roles --stats

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
python manage.py create_user admin admin@example.com --role "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã"
```

---

## üîß Troubleshooting

### 1. –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### OAuth –æ—à–∏–±–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ OAuth
python manage.py shell
>>> from django.conf import settings
>>> print(settings.SOCIALACCOUNT_PROVIDERS)

# –û—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–∏
python manage.py shell
>>> from django.contrib.sessions.models import Session
>>> Session.objects.all().delete()
```

#### API –∫–ª—é—á–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π
curl -X POST http://localhost:8000/accounts/api/test-gemini/ \
  -H "Content-Type: application/json" \
  -d '{"api_key": "test_key"}'
```

#### –†–æ–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è:
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π
python manage.py seed_roles
python manage.py seed_roles --validate
```

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

#### –õ–æ–≥–∏:
```bash
# Django –ª–æ–≥–∏
tail -f logs/django.log

# OAuth –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
curl http://localhost:8000/accounts/oauth-debug/

# API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
curl -X POST http://localhost:8000/accounts/api/test-gemini/ \
  -H "Content-Type: application/json" \
  -d '{"api_key": "test_key"}'
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Django
python manage.py check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
python manage.py showmigrations

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π
python manage.py seed_roles --validate
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

#### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pg_dump hrhelper > backup.sql

# –ë—ç–∫–∞–ø —Ñ–∞–π–ª–æ–≤
tar -czf files_backup.tar.gz media/ static/
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
psql hrhelper < backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
tar -xzf files_backup.tar.gz
```

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `accounts` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å:

1. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π** —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º —Å–ª–æ–µ–º
2. **–ì–∏–±–∫–æ–π —Å–∏—Å—Ç–µ–º–æ–π —Ä–æ–ª–µ–π** —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏** —á–µ—Ä–µ–∑ API
4. **–í—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
5. **–û—Ç–ª–∏—á–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é** –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é
6. **–ü–æ–ª–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º** –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
7. **–ü—Ä–æ—Å—Ç–æ–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º** –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
8. **JSON API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π** –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
9. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏** –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏
10. **Comprehensive –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π** –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **JSON API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - DRY –ø—Ä–∏–Ω—Ü–∏–ø –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- **–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- **REST API** - –ø–æ–ª–Ω–∞—è CRUD —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2024-01-20  
**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ  
**–ù–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** Complete ‚úÖ
